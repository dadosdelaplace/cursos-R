<!DOCTYPE html>
<html lang="es"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Curso impartido en RTVE • Javier Álvarez Liébana">
  <title>Curso de formación</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/rtve.webp" data-background-opacity="0.2" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title">Curso de formación</h1>
  <p class="subtitle">Análisis de datos en R para RTVE</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Curso impartido en RTVE • Javier Álvarez Liébana 
</div>
</div>
</div>

</section>
<section class="slide level2">

<div class="r-fit-text">
<p><span class="flow">¡Bienvenidos de nuevo a R!</span></p>
</div>
<p><span style="color:#444442;"><strong>¿Me habéis echado de menos? :)</strong></span></p>
</section>
<section id="buenas" class="slide level2">
<h2>¡Buenas!</h2>
<p><span class="hl-green"><strong>Correo</strong></span>: <strong><a href="mailto:javalv09@ucm.es" class="email">javalv09@ucm.es</a></strong>.</p>
<div class="columns">
<div class="column" style="width:25%;">
<p><img data-src="img/me.jpeg"></p>
</div><div class="column" style="width:75%;">
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Javier Álvarez Liébana</strong></span>, de Carabanchel. Licenciado en Matemáticas (UCM). <span class="hl-yellow"><strong>Doctor en estadística</strong></span> (UGR)</p></li>
<li class="fragment"><p>Encargado de la <span class="hl-yellow"><strong>visualización y análisis de datos covid</strong></span> del Principado de Asturias (2021-2022).</p></li>
<li class="fragment"><p>Miembro de la <span class="hl-yellow"><strong>Sociedad Española de Estadística e IO</strong></span> y la <span class="hl-yellow"><strong>Real Sociedad Matemática Española</strong></span>.</p></li>
<li class="fragment"><p>Formador de <code>R</code> ISCIII (actualmente) y el Ayuntamiento de Madrid (2024).</p></li>
</ul>
</div>
</div>
</div>
<p>Actualmente, <span class="hl-yellow"><strong>investigador y docente en la Facultad de Estadística de la UCM</strong></span>, e investigador colaborador del <span class="hl-yellow"><strong>Network Science Institute</strong></span> de la Northeastern University (Boston). Divulgando por <a href="https://twitter.com/dadosdelaplace"><strong>Twitter</strong></a> e <a href="https://instagram.com/javieralvarezliebana"><strong>Instagram</strong></a></p>
</section>
<section id="objetivos" class="slide level2">
<h2>Objetivos</h2>
<div class="columns">
<div class="column" style="width:37%;">
<p><img data-src="https://assets-global.website-files.com/6092cb6b4ac959f39728dd26/6188a97fa499b5fbfe410417_target%20(1).png"></p>
</div><div class="column" style="width:63%;">
<div>
<ul>
<li class="fragment"><p>Quitarnos el <span class="hl-yellow"><strong>miedo a los errores en programación</strong></span> → a programar se aprende programando</p></li>
<li class="fragment"><p>Entender los <span class="hl-yellow"><strong>conceptos básicos de R</strong></span> desde cero → aprender a abstraer ideas y algoritmos</p></li>
<li class="fragment"><p>Utilidad de programar → flujos de trabajo <span class="hl-yellow"><strong>reproducibles</strong>, <strong>transparentes</strong></span> y mantenibles</p></li>
<li class="fragment"><p>Profundizar en el <span class="hl-yellow"><strong>análisis y preprocesamiento</strong></span> de datos → <code>{tidyverse}</code></p></li>
<li class="fragment"><p>Adquirir habilidades en el <span class="hl-yellow"><strong>análisis estadísticos de los datos</strong></span></p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="planificacion" class="slide level2">
<h2>Planificación</h2>
<div class="column-screen-inset-right">
<div style="font-size:20px">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">CLASE</th>
<th style="text-align: center;">SEMANA</th>
<th style="text-align: center;">FECHAS</th>
<th style="text-align: center;">TOPIC</th>
<th style="text-align: center;">EJ.</th>
<th style="text-align: center;">WORKBOOK</th>
<th style="text-align: center;">ENTREGA</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-1">1</a></td>
<td style="text-align: center;">S1</td>
<td style="text-align: center;">8 ene</td>
<td style="text-align: center;">Repaso: re-toma de contacto</td>
<td style="text-align: center;"><a href="#/tu-turno-1-1">💻</a> <a href="#/tu-turno-1-2">💻</a> <a href="#/tu-turno-1-3">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-1-1">🐣</a> <a href="#/caso-practico-1-2">🐣</a> <a href="#/caso-practico-1-3">🐣</a> <a href="#/caso-practico-1-4">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-2">2</a></td>
<td style="text-align: center;">S2</td>
<td style="text-align: center;">13 ene</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;"><a href="#/caso-practico-2-1">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="materiales" class="slide level2">
<h2>Materiales</h2>
<ul>
<li><span class="hl-yellow"><strong>Diapositivas</strong></span>: diapositivas en <code>Quarto</code> disponibles y actualizadas en <strong><a href="https://javieralvarezliebana.es/cursos-R/RTVE-formacion/diapos/#/title-slide" class="uri">https://javieralvarezliebana.es/cursos-R/RTVE-formacion/diapos/#/title-slide</a></strong>. En el menú de las diapositivas (abajo a la izquierda) tienes una <span class="hl-yellow"><strong>opción para descargarlas en pdf</strong></span> en <code>Tools</code></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p><span class="hl-yellow"><strong>Material</strong></span>: <a href="https://javieralvarezliebana.quarto.pub/workbook-rtve"><strong>cuadernos de trabajo</strong></a> y materiales extras y <strong>resúmenes de paquetes</strong></p></li>
<li><p><span class="hl-yellow">🗃 <strong>Datos</strong></span>: datasets que usaremos a lo largo de la asignatura, disponibles en Github <strong><a href="https://github.com/dadosdelaplace/cursos-R/tree/main/RTVE-formacion/diapos/datos" class="uri">https://github.com/dadosdelaplace/cursos-R/tree/main/RTVE-formacion/diapos/datos</a></strong></p></li>
<li><p><span class="hl-yellow">📚 <strong>Recursos de apoyo</strong></span>: en inglés <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a> y en castellano <a href="https://cdr-book.github.io/" class="uri">https://cdr-book.github.io/</a>, y <a href="https://ivelasq.quarto.pub/intro-to-quarto/" class="uri">https://ivelasq.quarto.pub/intro-to-quarto/</a> para Quarto.</p></li>
</ul>
</section>
<section>
<section id="clase-1" class="title-slide slide level1 center">
<h1>Clase 1: <span class="flow">welcome to R again</span></h1>
<p><span style="color:#444442;"><strong>Refrescando R</strong></span></p>
<ul>
<li><a href="#/reminders">Reminders</a></li>
<li><a href="#/tidy-data">Tidy data</a></li>
<li><a href="#/tidy-data">Preprocesamiento: dplyr</a></li>
<li><a href="#/import-export">Importar y exportar</a></li>
</ul>
</section>
<section id="reminders" class="slide level2">
<h2>Reminder: ¿por qué programar?</h2>
<ul>
<li><p><span class="hl-yellow"><strong>Automatizar</strong></span> → te permitirá automatizar tareas recurrentes.</p></li>
<li><p><span class="hl-yellow"><strong>Replicabilidad</strong></span> → podrás replicar tu análisis siempre de la misma manera.</p></li>
<li><p><span class="hl-yellow"><strong>Flexibilidad</strong></span> → podrás adaptar el software a tus necesidades.</p></li>
<li><p><span class="hl-yellow"><strong>Transparencia</strong></span> → ser auditado por la comunidad.</p></li>
</ul>

<img data-src="img/the_general_problem.png" class="r-stretch"></section>
<section id="reminder-requisitos" class="slide level2">
<h2>Reminder: requisitos</h2>
<p>Por si se te había olvidado, para el curso los únicos requisitos serán:</p>
<ol type="1">
<li><span class="hl-yellow"><strong>Conexión a internet</strong></span> (para la descarga de algunos datos y paquetes).</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li><span class="hl-yellow"><strong>Instalar R</strong></span>: será nuestro lenguaje. La descarga la haremos (gratuitamente) desde <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a></li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><span class="hl-yellow"><strong>Instalar RStudio</strong></span> desde <a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a></li>
</ol>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/cranR.jpg" width="420"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rstudio.jpg" width="420"></p>
</div>
</div>
</div>
</section>
<section id="reminder-r-vs-rstudio" class="slide level2">
<h2>Reminder: R vs RStudio</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/gramatica.webp" width="360"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/word.jpg" width="430"></p>
</div>
</div>
<div class="fragment fade-in-then-out">
<p>Programaremos como escribimos (castellano, por ejemplo) → <code>R</code> es <span class="hl-yellow"><strong>lenguaje</strong></span></p>
</div>
<div class="fragment fade-up">
<ul>
<li>Necesitaremos una <span class="hl-yellow"><strong>gramática, un lenguaje</strong></span> (<code>R</code>)</li>
</ul>
<div class="fragment fade-in">
<ul>
<li>Y un entorno, por ejemplo un <span class="hl-yellow"><strong>Word</strong></span> (<code>RStudio</code>), para escribirlo</li>
</ul>
</div>
</div>
</section>
<section id="reminder-asignación-igual-argumentos" class="slide level2">
<h2>Reminder: asignación, ¿igual?, argumentos</h2>
<p>No se si recuerdas que en <code>R</code> vamos a distinguir <span class="hl-yellow"><strong>tres tipos de «igual»</strong></span>:</p>
<ul>
<li><span class="hl-yellow"><strong>Asignación</strong></span>: usaremos <code>&lt;-</code> para asignar el valor de la derecha a la variable cuyo nombre tenemos a la izquierda</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><span class="hl-yellow"><strong>Comparación lógica</strong></span>: usaremos <code>==</code> para preguntar si lo de la izquierda es igual a lo de la derecha (la respuesta será un vector lógico)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>a <span class="sc">==</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE</code></pre>
</div>
</div>
<ul>
<li><span class="hl-yellow"><strong>Argumentos</strong></span>: usaremos <code>=</code> para asignar argumentos dentro de una función</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">mean</span>(<span class="at">x =</span> a, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
</div>
</section>
<section id="reminder-errores-y-warning" class="slide level2">
<h2>Reminder: errores y warning</h2>
<p>Durante tu aprendizaje va a ser muy habitual que las cosas no salgan a la primera → <span class="hl-yellow"><strong>te vas equivocar</strong></span>. No solo será importante asumirlo sino que es <span class="hl-yellow"><strong>importante leer los mensajes de error</strong></span> para aprender de ellos.</p>
<div class="fragment">
<ul>
<li><span class="hl-red"><strong>Mensajes de error</strong></span>: precedidos de <strong>«Error in…»</strong> y serán aquellos fallos que <span class="hl-red"><strong>impidan la ejecución</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="st">"a"</span> <span class="sc">+</span> <span class="dv">1</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in "a" + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-orange"><strong>Mensajes de warning</strong></span>: precedidos de <strong>«Warning in…»</strong> son los (posibles) fallos más delicados ya que son incoherencias que <span class="hl-orange"><strong>no impiden la ejecución</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Ejecuta la orden pero el resultado es NaN, **Not A Number**, un valor que no existe</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(-1): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NaN</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-proyectos" class="slide level2">
<h2>Reminder: proyectos</h2>
<p>De la misma manera que en el ordenador solemos trabajar de manera <span class="hl-yellow"><strong>ordenada por carpetas</strong></span>, en <code>RStudio</code> podemos hacer lo mismo para trabajar de <span class="hl-yellow"><strong>manera eficaz creando proyectos</strong></span>.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<p>Un <span class="hl-yellow"><strong>proyecto será una «carpeta»</strong></span> dentro de <code>RStudio</code>, de manera que nuestro directorio raíz automáticamente será la propia carpeta de proyecto (pudiendo pasar de un proyecto a otro con el menu superior derecho).</p>
<p>Podemos crear uno en una carpeta nueva o en una carpeta ya existente.</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/rstudio_proyectos.png" width="370"></p>
</div>
</div>
</div>
</section>
<section id="reminder-tipos-de-datos" class="slide level2">
<h2>Reminder: tipos de datos</h2>
<p>¿Qué <span class="hl-yellow"><strong>tipo de dato</strong></span> podemos tener en cada celda de una <strong>tabla</strong>?</p>

<img data-src="img/celdas.jpg" class="r-stretch"><div>
<ul>
<li class="fragment"><span class="hl-yellow"><strong>Celda</strong></span>: dato individual de un tipo concreto.</li>
<li class="fragment"><span class="hl-yellow"><strong>Variable</strong></span>: <strong>concatenación</strong> de valores del mismo tipo (<span class="hl-purple"><strong>vectores en R</strong></span>).</li>
<li class="fragment"><span class="hl-yellow"><strong>Matriz</strong></span>: concatenación de variables del <strong>mismo tipo y longitud</strong>.</li>
<li class="fragment"><span class="hl-yellow"><strong>Tabla</strong></span>: concatenación de variables de <span class="hl-purple"><strong>distinto tipo pero igual longitud</strong></span></li>
<li class="fragment"><span class="hl-yellow"><strong>Lista</strong></span>: concatenación de variables de <span class="hl-purple"><strong>distinto tipo y distinta longitud</strong></span></li>
</ul>
</div>
</section>
<section id="reminder-tipos-de-datos-1" class="slide level2">
<h2>Reminder: tipos de datos</h2>
<p>¿Existen <span class="hl-yellow"><strong>variables más allá de los números</strong></span>? Piensa por ejemplo en los datos que podrías guardar de una persona:</p>
<div class="fragment fade-up">
<ul>
<li>La edad o el peso será un <span class="hl-yellow"><strong>número</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>edad <span class="ot">&lt;-</span> <span class="dv">33</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>Su nombre será una cadena de <span class="hl-yellow"><strong>texto (conocida como string o char)</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>nombre <span class="ot">&lt;-</span> <span class="st">"javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>A la pregunta «¿estás matriculado en la Facultad?» la respuesta será lo que llamamos una <span class="hl-yellow"><strong>variable lógica</strong></span> (<code>TRUE</code> si está matriculado o <code>FALSE</code> en otro caso).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>matriculado <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>Su fecha de nacimiento será precisamente eso, una <span class="hl-yellow"><strong>fecha</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>birth_day <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">as_date</span>(<span class="st">"1989-09-10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="reminder-tipos-de-datos-2" class="slide level2">
<h2>Reminder: tipos de datos</h2>
<p>Imagina que además de la edad de una persona queremos guardar su nombre: ahora la variable será de tipo <code>character</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>nombre <span class="ot">&lt;-</span> <span class="st">"Javier"</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">class</span>(nombre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<div class="fragment">
<p>Las <span class="hl-yellow"><strong>cadenas de texto</strong></span> son un tipo con el que obviamente <span class="hl-red"><strong>no podremos hacer operaciones aritméticas</strong></span> (sí otras operaciones como pegar o localizar patrones).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>nombre <span class="sc">+</span> <span class="dv">1</span> <span class="co"># error al sumar número a texto</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in nombre + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Recuerda que…</strong></p>
</div>
<div class="callout-content">
<p>Las variables de tipo texto (character o string) van <span class="hl-orange"><strong>SIEMPRE entre comillas</strong></span>: no es lo mismo <code>TRUE</code> (valor lógico, binario) que <code>"TRUE"</code> (texto).</p>
</div>
</div>
</div>
</div>
</section>
<section id="reminder-tipos-de-datos-3" class="slide level2">
<h2>Reminder: tipos de datos</h2>
<p>Otro tipo fundamental serán las <span class="hl-yellow"><strong>variables lógicas o binarias</strong></span> (<strong>dos valores</strong>):</p>
<ul>
<li><code>TRUE</code>: <span class="hl-yellow"><strong>verdadero</strong></span> guardado internamente como un 1.</li>
<li><code>FALSE</code>: <span class="hl-yellow"><strong>falso</strong></span> guardado internamente como un 0.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>soltero <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># ¿Es soltero? --&gt; SÍ</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">class</span>(soltero)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
<div class="fragment">
<p>Dado que internamente están guardados como variables binarias, podemos <span class="hl-yellow"><strong>realizar operaciones aritméticas</strong></span> con ellas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="cn">FALSE</span> <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-tipos-de-datos-4" class="slide level2">
<h2>Reminder: tipos de datos</h2>
<p>Las variables lógicas en realidad puede tomar un tercer valor: <code>NA</code> o <span class="hl-yellow"><strong>dato ausente</strong></span>, representando las siglas de <em>not available</em>, y será muy habitual encontrarlo dentro de una base de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>ausente <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>ausente <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante</strong></p>
</div>
<div class="callout-content">
<p>Las variables lógicas <span class="hl-red"><strong>NO son variables de texto</strong></span>: <code>"TRUE"</code> es un texto, <code>TRUE</code> es un valor lógico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="st">"TRUE"</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in "TRUE" + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="reminder-tipos-de-datos-5" class="slide level2">
<h2>Reminder: tipos de datos</h2>
<p>Un tipo de datos muy especial: los <span class="hl-yellow"><strong>datos de tipo fecha</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>fecha_char <span class="ot">&lt;-</span> <span class="st">"2021-04-21"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Parece una simple cadena de texto pero <span class="hl-yellow"><strong>debería representar un instante en el tiempo</strong></span>. ¿Qué debería suceder si <span class="hl-purple"><strong>sumamos un 1 a una fecha</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>fecha_char <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in fecha_char + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
<p>Las fechas <span class="hl-red"><strong>NO pueden ser texto</strong></span>: debemos convertir la cadena de texto a fecha. Para trabajar con fechas usaremos el paquete <code>{lubridate}</code>, que deberemos instalar antes de poder usarlo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">install.packages</span>(<span class="st">"lubridate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="reminder-vectores" class="slide level2">
<h2>Reminder: vectores</h2>
<p>Cuando trabajamos con datos normalmente tendremos <span class="hl-yellow"><strong>columnas que representan variables</strong></span>: llamaremos <span class="hl-yellow"><strong>vectores</strong></span> a una <span class="hl-purple"><strong>concatenación</strong></span> de celdas (valores) del <span class="hl-purple"><strong>mismo tipo</strong></span> (lo que sería una columna de una tabla).</p>
<div class="fragment">
<p>La forma más sencilla es con el comando <code>c()</code> (c de <strong>concatenar</strong>), y basta con introducir sus <strong>elementos entre paréntesis y separados por comas</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">27</span>, <span class="dv">60</span>, <span class="dv">61</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a>edades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32 27 60 61</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>La <span class="hl-yellow"><strong>longitud de un vector</strong></span> se puede calcular con <code>length()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">length</span>(edades)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-secuencias" class="slide level2">
<h2>Reminder: secuencias</h2>
<p>El vector más famoso será el de tipo numérico, y en concreto, las conocidas como <span class="hl-yellow"><strong>secuencias numéricas</strong></span>. El comando <code>seq(inicio, fin)</code> nos permite crear una <span class="hl-yellow"><strong>secuencia numérica</strong></span> desde un elemento inicial hasta uno final, <span class="hl-purple"><strong>avanzando de uno en uno</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">21</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21</code></pre>
</div>
</div>
<div class="fragment">
<p>Un atajo es el comando <code>1:n</code>, que nos devuelve lo mismo que <code>seq(1, n)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>También podemos definir <span class="hl-yellow"><strong>otro tipo de distancia</strong></span> (paso) entre consecutivos con el argumento <code>by = ...</code> o su longitud con <code>l = ...</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="at">by =</span> <span class="fl">0.5</span>) <span class="co"># secuencia desde 1 a 7 de 0.5 en 0.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">7</span>) <span class="co"># secuencia desde 1 a 50 de longitud 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.0  2.5  4.0  5.5  7.0  8.5 10.0</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-vectores-1" class="slide level2">
<h2>Reminder: vectores</h2>
<p>Con los vectores numéricos podemos hacer las mismas <span class="hl-yellow"><strong>operaciones aritméticas</strong></span> que con los números → un <span class="hl-purple"><strong>número es un vector</strong></span> (de longitud uno)</p>
<div class="fragment">
<p>¿Qué sucederá si <span class="hl-yellow"><strong>sumamos o restamos un valor</strong></span> a un vector?</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a>x <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 4 6 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>x <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  6 10 14</code></pre>
</div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Cuidado</strong></p>
</div>
<div class="callout-content">
<p>Salvo que indiquemos lo contrario, en <code>R</code> las operaciones con vectores son siempre <span class="hl-orange"><strong>elemento a elemento</strong></span></p>
</div>
</div>
</div>
</div>
</section>
<section id="reminder-vectores-2" class="slide level2">
<h2>Reminder: vectores</h2>
<p>Una operación muy habitual es <span class="hl-yellow"><strong>preguntar a los datos</strong></span> mediante el uso de <span class="hl-purple"><strong>condiciones lógicas</strong></span>. Por ejemplo, si definimos un vector de temperaturas…</p>
<p><span class="hl-yellow"><strong>¿Qué días hizo menos de 22 grados?</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">31</span>, <span class="dv">27</span>, <span class="dv">15</span>, <span class="dv">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>x <span class="sc">&lt;</span> <span class="dv">22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE  TRUE FALSE</code></pre>
</div>
</div>
<p>Nos devolverá un <span class="hl-yellow"><strong>vector lógico</strong></span>, en función de si <strong>cada elemento</strong> cumple o no la condición pedida (de <strong>igual longitud</strong> que el vector preguntado)</p>
</div>
<div class="fragment">
<p>Si tuviéramos un <span class="hl-yellow"><strong>dato ausente</strong></span> (por error del aparato ese día), la condición evaluada también sería <code>NA</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="cn">NA</span>, <span class="dv">31</span>, <span class="dv">27</span>, <span class="dv">7</span>, <span class="dv">29</span>, <span class="dv">10</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a>y <span class="sc">&lt;</span> <span class="dv">22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE    NA FALSE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-vectores-3" class="slide level2">
<h2>Reminder: vectores</h2>
<p>Las <span class="hl-yellow"><strong>condiciones lógicas pueden ser combinadas</strong></span> de dos maneras:</p>
<ul>
<li><span class="hl-yellow"><strong>Intersección</strong></span>: <span class="hl-purple"><strong>todas</strong></span> las condiciones concatenadas se deben cumplir (<span class="hl-purple"><strong>conjunción y</strong></span> con <code>&amp;</code>) para devolver un <code>TRUE</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>x <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> x <span class="sc">&gt;</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<ul>
<li><span class="hl-yellow"><strong>Unión</strong></span>: basta con que <span class="hl-purple"><strong>al menos una</strong></span> se cumpla (<span class="hl-purple"><strong>conjunción o</strong></span> con <code>|</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>x <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
</div>
</div>
<div class="fragment">
<p>Con <code>any()</code> y <code>all()</code> podemos comprobar que <span class="hl-yellow"><strong>todos los elementos</strong></span> cumplen</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">all</span>(x <span class="sc">&lt;</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-vectores-4" class="slide level2">
<h2>Reminder: vectores</h2>
<p>Otra operación muy habitual es la de <span class="hl-yellow"><strong>acceder a elementos</strong></span>. La forma más sencilla es usar el operador <code>[i]</code> (acceder al elemento i-ésimo)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">33</span>, <span class="cn">NA</span>, <span class="dv">61</span>) </span>
<span id="cb64-2"><a href="#cb64-2"></a>edades[<span class="dv">3</span>] <span class="co"># accedemos a la edad de la tercera persona </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33</code></pre>
</div>
</div>
<div class="fragment">
<p>Dado que un número no es más que un vector de longitud uno, esta operación también la podemos aplicar usando un <span class="hl-yellow"><strong>vector de índices a seleccionar</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hola"</span>, <span class="st">"qué"</span>, <span class="st">"tal"</span>, <span class="st">"estás"</span>, <span class="st">"?"</span>)</span>
<span id="cb66-2"><a href="#cb66-2"></a>y[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>)] <span class="co"># primer, segundo y cuarto elemento</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hola"  "qué"   "estás"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Consejo</strong></p>
</div>
<div class="callout-content">
<p>Para acceder al último, sin preocuparnos de cuál es, podemos pasarle como índice la propia longitud <code>x[length(x)]</code></p>
</div>
</div>
</div>
</div>
</section>
<section id="reminder-vectores-5" class="slide level2">
<h2>Reminder: vectores</h2>
<p>Otras veces no querremos seleccionar sino <span class="hl-yellow"><strong>eliminar algunos elementos</strong></span>. Deberemos repetir la misma operación pero con el signo - delante: el operador <code>[-i]</code> no selecciona el elemento i-ésimo del vector sino que lo «des-selecciona»</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hola"  "qué"   "tal"   "estás" "?"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>y[<span class="sc">-</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hola"  "tal"   "estás" "?"    </code></pre>
</div>
</div>
<div class="fragment">
<p>En muchas ocasiones los queremos <span class="hl-yellow"><strong>seleccionar o eliminar en base a condiciones lógicas</strong></span>, en función de los valores, así que pasaremos como índice la propia condición (recuerda, <code>x &lt; 2</code> nos devuelve un vector lógico)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">21</span>, <span class="dv">30</span>, <span class="dv">17</span>, <span class="dv">45</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a>nombres <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"maría"</span>, <span class="st">"laura"</span>, <span class="st">"carla"</span>, <span class="st">"luis"</span>)</span>
<span id="cb72-3"><a href="#cb72-3"></a>nombres[edades <span class="sc">&lt;</span> <span class="dv">18</span>] <span class="co"># nombres de los menores de edad</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "carla"</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-vectores-6" class="slide level2">
<h2>Reminder: vectores</h2>
<p>También podemos hacer uso de <span class="hl-yellow"><strong>operaciones estadísticas</strong></span> como por ejemplo <code>sum()</code> que, dado un vector, nos devuelve la suma de todos sus elementos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p><span class="hl-yellow"><strong>¿Qué sucede cuando falta un dato (ausente)?</strong></span></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>Por defecto, si tenemos un dato ausente, la <span class="hl-yellow"><strong>operación también será ausente</strong></span>. Para poder <span class="hl-purple"><strong>obviar ese dato</strong></span>, usamos un argumento opcional <code>na.rm = TRUE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-vectores-7" class="slide level2">
<h2>Reminder: vectores</h2>
<p>Por último, una acción habitual es saber <span class="hl-yellow"><strong>ordenar valores</strong></span>:</p>
<ul>
<li><code>sort()</code>: devuelve el <span class="hl-yellow"><strong>vector ordenado</strong></span>. Por defecto de menor a mayor pero con <code>decreasing = TRUE</code> podemos cambiarlo</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">81</span>, <span class="dv">7</span>, <span class="dv">25</span>, <span class="dv">41</span>, <span class="dv">65</span>, <span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">23</span>, <span class="dv">77</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="fu">sort</span>(edades)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7 20 23 25 33 41 65 77 81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="fu">sort</span>(edades, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81 77 65 41 33 25 23 20  7</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><code>order()</code>: devuelve el <span class="hl-yellow"><strong>vector de índices</strong></span> que tendríamos que usar para tener el vector ordenado</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">order</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 5 1 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>x[<span class="fu">order</span>(x)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2 -1  1  3 NA</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-bases-de-datos" class="slide level2">
<h2>Reminder: bases de datos</h2>
<p>Cuando analizamos datos solemos tener <span class="hl-yellow"><strong>varias variables</strong></span> de cada individuo: necesitamos una «tabla» que las recopile.</p>
<ul>
<li>La opción más inmediata son las <span class="hl-yellow"><strong>matrices</strong></span>: concatenación de variables del <span class="hl-purple"><strong>mismo tipo e igual longitud</strong></span>. La opción más habitual es usando <code>cbind()</code>: <span class="hl-yellow"><strong>concatenamos (bind) vectores en forma de columnas (c)</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>estaturas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">170</span>, <span class="dv">180</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a>pesos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">63</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb88-3"><a href="#cb88-3"></a>datos_matriz <span class="ot">&lt;-</span> <span class="fu">cbind</span>(estaturas, pesos)</span>
<span id="cb88-4"><a href="#cb88-4"></a>datos_matriz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     estaturas pesos
[1,]       150    63
[2,]       160    70
[3,]       170    85
[4,]       180    95</code></pre>
</div>
</div>
</section>
<section id="reminder-bases-de-datos-1" class="slide level2">
<h2>Reminder: bases de datos</h2>
<p>Dado que ahora tenemos dos dimensiones en nuestros datos, para <span class="hl-yellow"><strong>acceder a elementos con <code>[]</code></strong></span> deberemos proporcionar <strong>dos índices separados por comas</strong>: índice de la fila y de la columna</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>datos_matriz[<span class="dv">2</span>, <span class="dv">1</span>] <span class="co"># segunda fila, primera columna</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>estaturas 
      160 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>datos_matriz[<span class="dv">1</span>, <span class="dv">2</span>] <span class="co"># primera fila, segunda columna </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pesos 
   63 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>datos_matriz[<span class="dv">2</span>, ] <span class="co"># segundo individuo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>estaturas     pesos 
      160        70 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>datos_matriz[, <span class="dv">1</span>] <span class="co"># primera variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150 160 170 180</code></pre>
</div>
</div>
</section>
<section id="reminder-bases-de-datos-2" class="slide level2">
<h2>Reminder: bases de datos</h2>
<p>Las matrices tienen el mismo problema que los vectores: si juntamos datos de distinto tipo, se <span class="hl-red"><strong>perturba la integridad del dato</strong></span> ya que los convierte</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">24</span>, <span class="cn">NA</span>)</span>
<span id="cb98-2"><a href="#cb98-2"></a>soltero <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">NA</span>, <span class="cn">FALSE</span>)</span>
<span id="cb98-3"><a href="#cb98-3"></a>nombres <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"laura"</span>, <span class="st">"lucía"</span>)</span>
<span id="cb98-4"><a href="#cb98-4"></a>matriz <span class="ot">&lt;-</span> <span class="fu">cbind</span>(edades, soltero, nombres)</span>
<span id="cb98-5"><a href="#cb98-5"></a>matriz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     edades soltero nombres
[1,] "14"   "TRUE"  "javi" 
[2,] "24"   NA      "laura"
[3,] NA     "FALSE" "lucía"</code></pre>
</div>
</div>
<div class="fragment">
<p>Para poder trabajar con <span class="hl-yellow"><strong>variables de distinto tipo</strong></span> tenemos en <code>R</code> lo que se conoce como <span class="hl-yellow"><strong>data.frame</strong></span>: concatenación de variables de igual longitud pero que pueden ser de <span class="hl-purple"><strong>tipo distinto</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(edades, soltero, nombres)</span>
<span id="cb100-2"><a href="#cb100-2"></a>tabla</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  edades soltero nombres
1     14    TRUE    javi
2     24      NA   laura
3     NA   FALSE   lucía</code></pre>
</div>
</div>
</div>
</section>
<section id="reminder-bases-de-datos-3" class="slide level2">
<h2>Reminder: bases de datos</h2>
<p>Si queremos acceder a sus elementos, al ser de nuevo <strong>datos tabulados</strong>, podemos acceder como en las matrices (<span class="hl-red"><strong>no recomendable</strong></span>): de nuevo <span class="hl-yellow"><strong>tenemos dos índices</strong></span> (filas y columnas, dejando libre la que no usemos)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>tabla[<span class="dv">2</span>, ]  <span class="co"># segunda fila (todas sus variables)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  edades soltero nombres
2     24      NA   laura</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>tabla[, <span class="dv">3</span>]  <span class="co"># tercera columna (de todos los individuos)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "laura" "lucía"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>tabla[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># primera característica de la segunda persona</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:25%;">
<p><img data-src="img/menu_data_frame.jpg"></p>
</div><div class="column" style="width:75%;">
<p>Pero también tiene las ventajas de una <span class="hl-yellow"><strong>«base» de datos</strong></span> : podemos <span class="hl-purple"><strong>aceder a las variables por su nombre</strong></span> (<span class="hl-green"><strong>lo recomendable</strong></span> ya que las variables pueden cambiar de posición y ahora sí tienen un significado), poniendo el nombre de la tabla seguido del símbolo <code>$</code> (con el <strong>tabulador</strong>, nos aparecerá un menú de columnas a elegir)</p>
</div>
</div>
</div>
</section>
<section class="slide level2">

</section>
<section id="reminder-bases-de-datos-4" class="slide level2">
<h2>Reminder: bases de datos</h2>
<p>Las tablas en formato <code>data.frame</code> tienen algunas <span class="hl-red"><strong>limitaciones</strong></span>. La principal es que <span class="hl-red"><strong>no permite la recursividad</strong></span>. En adelante usaremos el formato <code>tibble</code> (<span class="hl-yellow"><strong>data.frame mejorado</strong></span>) del paquete <code>{tibble}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb108-2"><a href="#cb108-2"></a>datos_tb <span class="ot">&lt;-</span> </span>
<span id="cb108-3"><a href="#cb108-3"></a>  <span class="fu">tibble</span>(<span class="st">"estatura"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"peso"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb108-4"><a href="#cb108-4"></a>         <span class="st">"IMC"</span> <span class="ot">=</span> peso <span class="sc">/</span> (estatura<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb108-5"><a href="#cb108-5"></a><span class="fu">class</span>(datos_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a>datos_tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  estatura  peso   IMC
     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1      1.7    80  27.7
2      1.8    75  23.1
3      1.6    70  27.3</code></pre>
</div>
</div>
</section>
<section id="tu-turno-1-1" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-1-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-1-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-1-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-1-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li><li><a href="#tabset-1-6"><span class="hl-yellow"><strong>Ejercicio 6</strong></span></a></li><li><a href="#tabset-1-7"><span class="hl-yellow"><strong>Ejercicio 7</strong></span></a></li><li><a href="#tabset-1-8"><span class="hl-yellow"><strong>Ejercicio 8</strong></span></a></li><li><a href="#tabset-1-9"><span class="hl-yellow"><strong>Ejercicio 9</strong></span></a></li><li><a href="#tabset-1-10"><span class="hl-yellow"><strong>Ejercicio 10</strong></span></a></li><li><a href="#tabset-1-11"><span class="hl-yellow"><strong>Ejercicio 11</strong></span></a></li><li><a href="#tabset-1-12"><span class="hl-yellow"><strong>Ejercicio 12</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<p>📝 Define el vector <code>x</code> como la concatenación de los 5 primeros números impares. Calcula la longitud del vector</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># Dos formas</span></span>
<span id="cb112-2"><a href="#cb112-2"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb112-3"><a href="#cb112-3"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb112-4"><a href="#cb112-4"></a></span>
<span id="cb112-5"><a href="#cb112-5"></a><span class="fu">length</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2">
<p>📝 Accede al tercer elemento de <code>x</code>. Accede al último elemento (sin importar la longitud, un código que pueda ejecutarse siempre). Elimina el primer elemento.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>x[<span class="dv">3</span>]</span>
<span id="cb113-2"><a href="#cb113-2"></a>x[<span class="fu">length</span>(x)]</span>
<span id="cb113-3"><a href="#cb113-3"></a>x[<span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3">
<p>📝 Obtén los elementos de <code>x</code> mayores que 4. Calcula el vector <code>1/x</code> y guárdalo en una variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">4</span>]</span>
<span id="cb114-2"><a href="#cb114-2"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>x</span>
<span id="cb114-3"><a href="#cb114-3"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-4">
<p>📝 Crea un vector que represente los nombres de 5 personas, de los cuales uno es desconocido.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>nombres <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Javi"</span>, <span class="st">"Sandra"</span>, <span class="cn">NA</span>, <span class="st">"Laura"</span>, <span class="st">"Carlos"</span>)</span>
<span id="cb115-2"><a href="#cb115-2"></a>nombres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-5">
<p>📝 Encuentra del vector <code>x</code> de ejercicios anteriores los elementos mayores (estrictos) que 1 Y ADEMÁS menores (estrictos) que 7. Encuentra una forma de averiguar si todos los elementos son o no positivos.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">7</span>]</span>
<span id="cb116-2"><a href="#cb116-2"></a><span class="fu">all</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-6">
<p>📝 Dado el vector <code>x</code> del ejercicio anterior, ¿cuales tienen un dato ausente? Pista: las funciones <code>is.algo()</code> comprueban si el elemento es tipo <code>algo</code> (tabula)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="fu">is.na</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-7">
<p>📝 Calcula el vector <code>1/x</code> y obtén la versión ordenada (de menor a mayor) de las dos formas posibles</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>x</span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="fu">sort</span>(z)</span>
<span id="cb118-3"><a href="#cb118-3"></a>z[<span class="fu">order</span>(z)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-8">
<p>📝 Encuentra del vector <code>x</code> los elementos mayores (estrictos) que 1 y menores (estrictos) que 6. Encuentra una forma de averiguar si todos los elementos son o no negativos.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">7</span>]</span>
<span id="cb119-2"><a href="#cb119-2"></a><span class="fu">all</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-9">
<p>📝 Carga del paquete <code>{datasets}</code> el conjunto de datos <code>airquality</code> (variables de la calidad del aire de Nueva York desde mayo hasta septiembre de 1973). ¿Es el conjunto de datos airquality de tipo tibble? En caso negativo, conviértelo a tibble (busca en la documentación del paquete en <a href="https://tibble.tidyverse.org/index.html" class="uri">https://tibble.tidyverse.org/index.html</a>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb120-2"><a href="#cb120-2"></a><span class="fu">class</span>(datasets<span class="sc">::</span>airquality)</span>
<span id="cb120-3"><a href="#cb120-3"></a>airquality_tb <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(datasets<span class="sc">::</span>airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-10">
<p>📝 Una vez convertido a <code>tibble</code> obtén el nombre de las variables y las dimensiones del conjunto de datos. ¿Cuántas variables hay? ¿Cuántos días se han medido?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="fu">names</span>(airquality_tb)</span>
<span id="cb121-2"><a href="#cb121-2"></a><span class="fu">ncol</span>(airquality_tb)</span>
<span id="cb121-3"><a href="#cb121-3"></a><span class="fu">nrow</span>(airquality_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-11">
<p>📝 Cambia el código inferior para filtrar solo los datos de la quinta observación</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>airquality_tb[Month <span class="sc">==</span> <span class="dv">8</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>airquality_tb[<span class="dv">5</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-12">
<p>📝 Cambia el código inferior para filtrar solo los datos del mes de agosto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a>airquality_tb[Month <span class="sc">==</span> <span class="dv">8</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>airquality_tb[airquality_tb<span class="sc">$</span>Month <span class="sc">==</span> <span class="dv">8</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-1-1" class="slide level2">
<h2>🐣 Caso práctico I: manejo de vectores</h2>
<p>En el paquete <code>{datasets}</code> (ya instalado por defecto) tenemos diversos conjuntos de datos y uno de ellos es <code>airquality</code>.</p>
<p>Los datos capturan <span class="hl-yellow"><strong>medidas diarias (n = 153 observaciones) de la calidad del aire</strong></span> en Nueva York, de mayo a septiembre de 1973. Se midieron <strong>6 variables</strong>: niveles de ozono, radiación solar, viento, temperatura, mes y día.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb126-2"><a href="#cb126-2"></a>airquality</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Intenta responder a las preguntas planteadas en el <a href="https://javieralvarezliebana.quarto.pub/workbook-rtve/#caso-pr%C3%A1ctico-i-airquality-manejo-de-vectores"><strong>workbook</strong></a></p>
</section>
<section id="tidy-data" class="slide level2">
<h2>¿Qué era tidyverse?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/flow_tidyverse.jpg"></p>
</div>
</div>
<p>En ese contexto de programación funcional, hace una década nacía <code>{tidyverse}</code>, un <span class="hl-yellow"><strong>«universo» de paquetes</strong></span> para garantizar un flujo de trabajo eficiente, coherente y lexicográficamente sencillo de entender, basado en la idea de que <span class="hl-purple"><strong>nuestros datos están limpios y ordenados (tidy)</strong></span></p>
</section>
<section id="qué-era-tidyverse" class="slide level2">
<h2>¿Qué era tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
<ul>
<li><code>{lubridate}</code> manejo de fechas</li>
<li><code>{rvest}</code>: web scraping</li>
<li><code>{tidymodels}</code>: modelización/predicción</li>
</ul>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: optimizando data.frame</li>
<li><code>{tidyr}</code>: limpieza de datos</li>
<li><code>{readr}</code>: carga datos rectangulares (.csv), <code>{readxl}</code> para importar archivos .xls y .xlsx</li>
<li><code>{dplyr}</code>: gramática para depurar</li>
<li><code>{stringr}</code>: manejo de textos</li>
<li><code>{purrr}</code>: manejo de listas</li>
<li><code>{forcats}</code>: manejo de cualitativas</li>
<li><code>{ggplot2}</code>: visualización de datos</li>
</ul>
</div>
</div>
</section>
<section id="qué-era-tidyverse-1" class="slide level2">
<h2>¿Qué era tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
<ul>
<li><code>{lubridate}</code> manejo de fechas</li>
<li><code>{rvest}</code>: web scraping</li>
<li><code>{tidymodels}</code>: modelización/predicción</li>
</ul>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: <span class="hl-yellow"><strong>optimizando data.frame</strong></span></li>
<li><code>{tidyr}</code>: <span class="hl-yellow"><strong>limpieza de datos</strong></span></li>
<li><code>{readr}</code>: carga datos rectangulares (.csv), <code>{readxl}</code> para importar archivos .xls y .xlsx</li>
<li><code>{dplyr}</code>: gramática para depurar</li>
<li><code>{stringr}</code>: manejo de textos</li>
<li><code>{purrr}</code>: manejo de listas</li>
<li><code>{forcats}</code>: manejo de cualitativas</li>
<li><code>{ggplot2}</code>: visualización de datos</li>
</ul>
</div>
</div>
</section>
<section id="filosofía-base-tidy-data" class="slide level2">
<h2>Filosofía base: tidy data</h2>
<blockquote>
<p>Tidy datasets are all alike, but every messy dataset is messy in its own way (Hadley Wickham, Chief Scientist en RStudio)</p>
</blockquote>
<div style="font-size:120px; text-align: center; color:#F8DF58;">
<p><b>TIDY</b><b><span style="color:#CAB0EE;">VERSE</span></b></p>
</div>
<p>El <span class="hl-purple"><strong>universo</strong></span> de paquetes <code>{tidyverse}</code> se basa en la idea introducida por <strong>Hadley Wickham</strong> (el Dios al que rezamos) de <span class="hl-yellow"><strong>estandarizar</strong></span> el formato de los datos para</p>
<div>
<ul>
<li class="fragment"><span class="hl-green"><strong>sistematizar</strong></span> la depuración</li>
<li class="fragment">hacer más <span class="hl-green"><strong>sencillo</strong></span> su manipulación.</li>
<li class="fragment">código <span class="hl-green"><strong>legible</strong></span></li>
</ul>
</div>
</section>
<section id="reglas-del-tidy-data" class="slide level2">
<h2>Reglas del tidy data</h2>
<p>Lo primero por tanto será entender qué son los <span class="hl-yellow"><strong>conjuntos tidydata</strong></span> ya que todo <code>{tidyverse}</code> se basa en que los datos están estandarizados.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment fade-in">
<ol type="1">
<li>Cada <span class="hl-yellow"><strong>variable</strong></span> en una <span class="hl-purple"><strong>única columna</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="2" type="1">
<li>Cada <span class="hl-yellow"><strong>individuo</strong></span> en una <span class="hl-purple"><strong>fila diferente</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="3" type="1">
<li>Cada <span class="hl-yellow"><strong>celda</strong></span> con un <span class="hl-purple"><strong>único valor</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="4" type="1">
<li>Cada <span class="hl-yellow"><strong>dataset</strong></span> en un <span class="hl-purple"><strong>tibble</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="5" type="1">
<li>Si queremos cruzar <span class="hl-yellow"><strong>múltiples tablas</strong></span> debemos tener una <span class="hl-purple"><strong>columna común</strong></span></li>
</ol>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidy_def.jpg" style="width:160.0%"></p>
</div>
</div>
</section>
<section id="tubería-pipe" class="slide level2">
<h2>Tubería (pipe)</h2>
<p>En <code>{tidyverse}</code> será clave el <span class="hl-yellow"><strong>operador pipe (tubería)</strong></span> definido como <code>|&gt;</code> (<span class="hl-purple"><strong>ctrl+shift+M</strong></span>): será una <span class="hl-yellow"><strong>tubería que recorre los datos</strong></span> y los transforma.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<p>En R base, si queremos aplicar tres funciones <code>first()</code>, <code>second()</code> y <code>third()</code> en orden, sería</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="fu">third</span>(<span class="fu">second</span>(<span class="fu">first</span>(datos)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<p>En <code>{tidyverse}</code> podremos <span class="hl-yellow"><strong>leer de izquierda a derecha</strong></span> y separar los datos de las acciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">first</span>() <span class="sc">|&gt;</span> <span class="fu">second</span>() <span class="sc">|&gt;</span> <span class="fu">third</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Apunte importante</strong></p>
</div>
<div class="callout-content">
<p>Desde la versión 4.1.0 de <code>R</code> disponemos de <code>|&gt;</code>, un pipe <strong>nativo</strong> disponible <span class="hl-purple"><strong>fuera de tidyverse</strong></span>, sustituyendo al <span class="hl-red"><strong>antiguo pipe</strong></span> <code>%&gt;%</code> que dependía del paquete <code>{magrittr}</code> (bastante problemático).</p>
</div>
</div>
</div>
</div>
</section>
<section id="tubería-pipe-1" class="slide level2">
<h2>Tubería (pipe)</h2>
<p>La principal ventaja es que el <span class="hl-yellow"><strong>código sea muy legible (casi literal)</strong></span> pudiendo hacer grandes operaciones con los datos con apenas código.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb129-2"><a href="#cb129-2"></a>  <span class="fu">limpio</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-3"><a href="#cb129-3"></a>  <span class="fu">filtro</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-4"><a href="#cb129-4"></a>  <span class="fu">selecciono</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-5"><a href="#cb129-5"></a>  <span class="fu">ordeno</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-6"><a href="#cb129-6"></a>  <span class="fu">modifico</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-7"><a href="#cb129-7"></a>  <span class="fu">renombro</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-8"><a href="#cb129-8"></a>  <span class="fu">agrupo</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-9"><a href="#cb129-9"></a>  <span class="fu">cuento</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-10"><a href="#cb129-10"></a>  <span class="fu">resumo</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb129-11"><a href="#cb129-11"></a>  <span class="fu">pinto</span>(...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<center>
<img src="img/logo_pipe.png" width="360px">
</center>
</div>
</div>
</section>
<section id="datos-sucios-messy-data" class="slide level2">
<h2>Datos SUCIOS: messy data</h2>
<p>¿Pero qué aspecto tienen los <span class="hl-yellow"><strong>datos no tidy</strong></span>? Vamos a cargar la tabla <code>table4a</code> del paquete <code>{tidyr}</code> (ya lo tenemos cargado del entorno tidyverse).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb130-2"><a href="#cb130-2"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>¿Qué puede estar fallando?</strong></span></p>
</section>
<section id="pivotar-pivot_longer" class="slide level2">
<h2>Pivotar: pivot_longer()</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>❎ Cada <span class="hl-red"><strong>fila representa dos observaciones</strong></span> (1999 y 2000) → las columnas <code>1999</code> y <code>2000</code> en realidad deberían ser en sí <span class="hl-yellow"><strong>valores de una variable</strong></span> y no nombres de columnas.</p>
</div>
</div>
<div class="fragment">
<p>Incluiremos una <span class="hl-yellow"><strong>nueva columna</strong></span> que nos guarde el año y otra que guarde el valor de la variable de interés en cada uno de esos años. Y lo haremos con la función <code>pivot_longer()</code>: <span class="hl-yellow"><strong>pivotaremos la tabla</strong></span> a formato long:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>table4a <span class="sc">|&gt;</span> </span>
<span id="cb134-2"><a href="#cb134-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"1999"</span>, <span class="st">"2000"</span>), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</div>
</section>
<section id="pivotar-pivot_longer-1" class="slide level2">
<h2>Pivotar: pivot_longer()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>table4a <span class="sc">|&gt;</span> </span>
<span id="cb136-2"><a href="#cb136-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"1999"</span>, <span class="st">"2000"</span>),</span>
<span id="cb136-3"><a href="#cb136-3"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb136-4"><a href="#cb136-4"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/table4a.jpg"></p>
</div>
</div>
<ul>
<li><code>cols</code>: <span class="hl-yellow"><strong>nombre de las variables a pivotar</strong></span></li>
<li><code>names_to</code>: nombre de la nueva variable a la quemandamos la <span class="hl-yellow"><strong>cabecera</strong></span> de la tabla (los nombres).</li>
<li><code>values_to</code>: nombre de la nueva variable a la que vamos a mandar los <span class="hl-yellow"><strong>datos</strong></span>.</li>
</ul>
</section>
<section id="datos-sucios-messy-data-1" class="slide level2">
<h2>Datos SUCIOS: messy data</h2>
<p>Veamos otro ejemplo con la tabla <code>table2</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>¿Qué puede estar fallando?</strong></span></p>
</section>
<section id="pivotar-pivot_wider" class="slide level2">
<h2>Pivotar: pivot_wider()</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>❎ Cada <span class="hl-red"><strong>observación está dividido en dos filas</strong></span> → los <span class="hl-yellow"><strong>registros con el mismo año deberían ser el mismo</strong></span></p>
</div>
</div>
<div class="fragment">
<p>Lo que haremos será lo opuesto: con <code>pivot_wider()</code> <span class="hl-yellow"><strong>ensancharemos la tabla</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>table2 <span class="sc">|&gt;</span>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="datos-sucios-messy-data-2" class="slide level2">
<h2>Datos SUCIOS: messy data</h2>
<p>Veamos otro ejemplo con la tabla <code>table3</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>¿Qué puede estar fallando?</strong></span></p>
</section>
<section id="separar-separate" class="slide level2">
<h2>Separar: separate()</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>❎ Cada <span class="hl-red"><strong>celda contiene varios valores</strong></span></p>
</div>
</div>
<div class="fragment">
<p>Lo que haremos será hacer uso de la función <code>separate()</code> para mandar <span class="hl-yellow"><strong>separar cada valor</strong></span> a una columna diferente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  pop       
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="separar-separate-1" class="slide level2">
<h2>Separar: separate()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  pop       
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
<p>Fíjate que los datos, aunque los ha separado, <span class="hl-red"><strong>los ha mantenido como texto</strong></span> cuando en realidad deberían ser variables numéricas. Para ello podemos añadir el argumento opcional <code>convert = TRUE</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>), <span class="at">convert =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases        pop
  &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="datos-sucios-messy-data-3" class="slide level2">
<h2>Datos SUCIOS: messy data</h2>
<p>Veamos el último ejemplo con la tabla <code>table5</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>¿Qué puede estar fallando?</strong></span></p>
</section>
<section id="unir-unite" class="slide level2">
<h2>Unir unite()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>❎ Tenemos <span class="hl-red"><strong>mismos valores divididos en dos columnas</strong></span></p>
</div>
</div>
<div class="fragment">
<p>Usaremos <code>unite()</code> para <span class="hl-yellow"><strong>unir los valores</strong></span> de siglo y año en una misma columna</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a>table5 <span class="sc">|&gt;</span> <span class="fu">unite</span>(<span class="at">col =</span> year_completo, century, year, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year_completo rate             
  &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;            
1 Afghanistan 1999          745/19987071     
2 Afghanistan 2000          2666/20595360    
3 Brazil      1999          37737/172006362  
4 Brazil      2000          80488/174504898  
5 China       1999          212258/1272915272
6 China       2000          213766/1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="ejemplo-relig_income" class="slide level2">
<h2>Ejemplo: relig_income</h2>
<p>Vamos a realizar un ejemplo juntos con la tabla <code>relig_income</code> del paquete <code>{tidyr}</code>. Como se indica en la ayuda <code>? relig_income</code>, la tabla representa la cantidad de personas que hay en cada tramo de ingresos anuales (20k = 20 000$) y en cada religión.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a>relig_income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 11
   religion `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`
   &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 Agnostic      27        34        60        81        76       137        122
 2 Atheist       12        27        37        52        35        70         73
 3 Buddhist      27        21        30        34        33        58         62
 4 Catholic     418       617       732       670       638      1116        949
 5 Don’t k…      15        14        15        11        10        35         21
 6 Evangel…     575       869      1064       982       881      1486        949
 7 Hindu          1         9         7         9        11        34         47
 8 Histori…     228       244       236       238       197       223        131
 9 Jehovah…      20        27        24        24        21        30         15
10 Jewish        19        19        25        25        30        95         69
11 Mainlin…     289       495       619       655       651      1107        939
12 Mormon        29        40        48        51        56       112         85
13 Muslim         6         7         9        10         9        23         16
14 Orthodox      13        17        23        32        32        47         38
15 Other C…       9         7        11        13        13        14         18
16 Other F…      20        33        40        46        49        63         46
17 Other W…       5         2         3         4         2         7          3
18 Unaffil…     217       299       374       365       341       528        407
# ℹ 3 more variables: `$100-150k` &lt;dbl&gt;, `&gt;150k` &lt;dbl&gt;,
#   `Don't know/refused` &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="ejemplo-relig_income-1" class="slide level2">
<h2>Ejemplo: relig_income</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a>relig_income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 11
   religion `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`
   &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 Agnostic      27        34        60        81        76       137        122
 2 Atheist       12        27        37        52        35        70         73
 3 Buddhist      27        21        30        34        33        58         62
 4 Catholic     418       617       732       670       638      1116        949
 5 Don’t k…      15        14        15        11        10        35         21
 6 Evangel…     575       869      1064       982       881      1486        949
 7 Hindu          1         9         7         9        11        34         47
 8 Histori…     228       244       236       238       197       223        131
 9 Jehovah…      20        27        24        24        21        30         15
10 Jewish        19        19        25        25        30        95         69
11 Mainlin…     289       495       619       655       651      1107        939
12 Mormon        29        40        48        51        56       112         85
13 Muslim         6         7         9        10         9        23         16
14 Orthodox      13        17        23        32        32        47         38
15 Other C…       9         7        11        13        13        14         18
16 Other F…      20        33        40        46        49        63         46
17 Other W…       5         2         3         4         2         7          3
18 Unaffil…     217       299       374       365       341       528        407
# ℹ 3 more variables: `$100-150k` &lt;dbl&gt;, `&gt;150k` &lt;dbl&gt;,
#   `Don't know/refused` &lt;dbl&gt;</code></pre>
</div>
</div>
<p><span class="hl-yellow"><strong>¿Es tidydata?</strong></span></p>
</section>
<section id="ejemplo-relig_income-2" class="slide level2">
<h2>Ejemplo: relig_income</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a>relig_income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 11
   religion `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`
   &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 Agnostic      27        34        60        81        76       137        122
 2 Atheist       12        27        37        52        35        70         73
 3 Buddhist      27        21        30        34        33        58         62
 4 Catholic     418       617       732       670       638      1116        949
 5 Don’t k…      15        14        15        11        10        35         21
 6 Evangel…     575       869      1064       982       881      1486        949
 7 Hindu          1         9         7         9        11        34         47
 8 Histori…     228       244       236       238       197       223        131
 9 Jehovah…      20        27        24        24        21        30         15
10 Jewish        19        19        25        25        30        95         69
11 Mainlin…     289       495       619       655       651      1107        939
12 Mormon        29        40        48        51        56       112         85
13 Muslim         6         7         9        10         9        23         16
14 Orthodox      13        17        23        32        32        47         38
15 Other C…       9         7        11        13        13        14         18
16 Other F…      20        33        40        46        49        63         46
17 Other W…       5         2         3         4         2         7          3
18 Unaffil…     217       299       374       365       341       528        407
# ℹ 3 more variables: `$100-150k` &lt;dbl&gt;, `&gt;150k` &lt;dbl&gt;,
#   `Don't know/refused` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>No lo es ya que en realidad <span class="hl-red"><strong>solo deberíamos tener una variable de ingresos</strong></span> y la tenemos dividida en 11: todas ellas es la misma variable solo que adopta un valor diferente. <span class="hl-green"><strong>¿Cómo convertirla a tidy data?</strong></span></p>
</section>
<section id="ejemplo-relig_income-3" class="slide level2">
<h2>Ejemplo: relig_income</h2>
<p>La idea es <span class="hl-yellow"><strong>pivotar todas las columnas de ingresos</strong></span> para que acaben en una sola columna llamada <code>income</code>, y los valores (el número de personas) en otra llamada <code>people</code> (por ejemplo). La tabla la haremos más larga y menos ancha así que…</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a>relig_tidy <span class="ot">&lt;-</span></span>
<span id="cb165-2"><a href="#cb165-2"></a>  relig_income <span class="sc">|&gt;</span></span>
<span id="cb165-3"><a href="#cb165-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"&lt;$10k"</span><span class="sc">:</span><span class="st">"Don't know/refused"</span>, <span class="at">names_to =</span> <span class="st">"income"</span>,</span>
<span id="cb165-4"><a href="#cb165-4"></a>               <span class="at">values_to =</span> <span class="st">"people"</span>)</span>
<span id="cb165-5"><a href="#cb165-5"></a>relig_tidy </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 180 × 3
   religion income             people
   &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;
 1 Agnostic &lt;$10k                  27
 2 Agnostic $10-20k                34
 3 Agnostic $20-30k                60
 4 Agnostic $30-40k                81
 5 Agnostic $40-50k                76
 6 Agnostic $50-75k               137
 7 Agnostic $75-100k              122
 8 Agnostic $100-150k             109
 9 Agnostic &gt;150k                  84
10 Agnostic Don't know/refused     96
# ℹ 170 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="ejemplo-relig_income-4" class="slide level2">
<h2>Ejemplo: relig_income</h2>
<p>Vamos a hilar más fino: ahora mismo en la variable <code>income</code> en realidad tenemos dos valores, el límite inferior y el superior de la renta. Vamos a <span class="hl-yellow"><strong>separar dicha variable e ingresos</strong></span> en dos, llamadas <code>income_inf</code> y <code>income_sup</code></p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a>relig_tidy <span class="sc">|&gt;</span></span>
<span id="cb167-2"><a href="#cb167-2"></a>  <span class="co"># Separamos por -</span></span>
<span id="cb167-3"><a href="#cb167-3"></a>  <span class="fu">separate</span>(income, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"income_inf"</span>, <span class="st">"income_sup"</span>), <span class="at">sep =</span> <span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 180 × 4
   religion income_inf         income_sup people
   &lt;chr&gt;    &lt;chr&gt;              &lt;chr&gt;       &lt;dbl&gt;
 1 Agnostic &lt;$10k              &lt;NA&gt;           27
 2 Agnostic $10                20k            34
 3 Agnostic $20                30k            60
 4 Agnostic $30                40k            81
 5 Agnostic $40                50k            76
 6 Agnostic $50                75k           137
 7 Agnostic $75                100k          122
 8 Agnostic $100               150k          109
 9 Agnostic &gt;150k              &lt;NA&gt;           84
10 Agnostic Don't know/refused &lt;NA&gt;           96
# ℹ 170 more rows</code></pre>
</div>
</div>
<div class="fragment">
<p>¿Está ya ok? Fíjate bien…</p>
</div>
</section>
<section id="ejemplo-relig_income-5" class="slide level2">
<h2>Ejemplo: relig_income</h2>
<p>Si te fijas la primera columna el <code>"$10k"</code> debería ser una cota superior, no inferior. ¿Cómo indicarle que separe bien ese caso?</p>
<div class="fragment">
<p>Le indicaremos que separe si encuentra <code>"-"</code> o <code>"&lt;"</code> (usamos <code>|</code> para separar ambas opciones)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1"></a>relig_tidy <span class="ot">&lt;-</span></span>
<span id="cb169-2"><a href="#cb169-2"></a>  relig_tidy <span class="sc">|&gt;</span></span>
<span id="cb169-3"><a href="#cb169-3"></a>  <span class="co"># Separamos por -</span></span>
<span id="cb169-4"><a href="#cb169-4"></a>  <span class="fu">separate</span>(income, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"income_inf"</span>, <span class="st">"income_sup"</span>), <span class="at">sep =</span> <span class="st">"-|&lt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="ejemplo-relig_income-6" class="slide level2">
<h2>Ejemplo: relig_income</h2>
<p>Piensa ahora como podemos <span class="hl-yellow"><strong>convertir los límites de ingresos a numéricas (eliminando símbolos, letras, etc)</strong></span></p>
<div class="fragment">
<p>Para ello usaremos el paquete <code>{stringr}</code>, en concreto la función <code>str_remove_all()</code> a la que le podemos pasar los caracteres que queremos eliminar (fíjate que <code>$</code> al ser un caracter reservado en <code>R</code> hay que indicárselo con <code>\\$</code>)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb170-2"><a href="#cb170-2"></a>relig_tidy<span class="sc">$</span>income_inf <span class="ot">&lt;-</span></span>
<span id="cb170-3"><a href="#cb170-3"></a>  <span class="fu">str_remove_all</span>(relig_tidy<span class="sc">$</span>income_inf, <span class="st">"</span><span class="sc">\\</span><span class="st">$|&gt;|k"</span>)</span>
<span id="cb170-4"><a href="#cb170-4"></a>relig_tidy<span class="sc">$</span>income_sup <span class="ot">&lt;-</span></span>
<span id="cb170-5"><a href="#cb170-5"></a>  <span class="fu">str_remove_all</span>(relig_tidy<span class="sc">$</span>income_sup, <span class="st">"</span><span class="sc">\\</span><span class="st">$|&gt;|k"</span>)</span>
<span id="cb170-6"><a href="#cb170-6"></a></span>
<span id="cb170-7"><a href="#cb170-7"></a>relig_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 180 × 4
   religion income_inf          income_sup people
   &lt;chr&gt;    &lt;chr&gt;               &lt;chr&gt;       &lt;dbl&gt;
 1 Agnostic ""                  10             27
 2 Agnostic "10"                20             34
 3 Agnostic "20"                30             60
 4 Agnostic "30"                40             81
 5 Agnostic "40"                50             76
 6 Agnostic "50"                75            137
 7 Agnostic "75"                100           122
 8 Agnostic "100"               150           109
 9 Agnostic "150"               &lt;NA&gt;           84
10 Agnostic "Don't now/refused" &lt;NA&gt;           96
# ℹ 170 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-1-2" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-2-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-2-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-2-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-2-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<p>📝 Echa un vistazo a la tabla <code>table4b</code> del paquete <code>{tidyr}</code>. ¿Es tidydata? En caso negativo, ¿qué falla? ¿Cómo convertirla a tidy data en caso de que no lo sea ya?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1"></a>table4b <span class="sc">|&gt;</span></span>
<span id="cb172-2"><a href="#cb172-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"1999"</span><span class="sc">:</span><span class="st">"2000"</span>, <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb172-3"><a href="#cb172-3"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2">
<p>📝 Echa un vistazo a la tabla <code>billboard</code> del paquete <code>{tidyr}</code>. ¿Es tidydata? En caso negativo, ¿qué falla? ¿Cómo convertirla a tidy data en caso de que no lo sea ya?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>billboard <span class="sc">|&gt;</span></span>
<span id="cb173-2"><a href="#cb173-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"wk1"</span><span class="sc">:</span><span class="st">"wk76"</span>,</span>
<span id="cb173-3"><a href="#cb173-3"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>,</span>
<span id="cb173-4"><a href="#cb173-4"></a>               <span class="at">names_prefix =</span> <span class="st">"wk"</span>,</span>
<span id="cb173-5"><a href="#cb173-5"></a>               <span class="at">values_to =</span> <span class="st">"position"</span>,</span>
<span id="cb173-6"><a href="#cb173-6"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-3">
<p>📝 En el paquete <code>{tidyr}</code> contamos con el dataset <code>who2</code> (dataset de la Organización Mundial de la Salud). ¿Es tidy data? ¿Por qué? Convierte a tidy data</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb174-2"><a href="#cb174-2"></a>  who2 <span class="sc">|&gt;</span> </span>
<span id="cb174-3"><a href="#cb174-3"></a>  <span class="co"># con values_drop_na = TRUE eliminamos los NA</span></span>
<span id="cb174-4"><a href="#cb174-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>(country<span class="sc">:</span>year), <span class="at">names_to =</span> <span class="st">"type"</span>,</span>
<span id="cb174-5"><a href="#cb174-5"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>, <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span>
<span id="cb174-6"><a href="#cb174-6"></a>who_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 76,046 × 4
   country      year type      cases
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 Afghanistan  1997 sp_m_014      0
 2 Afghanistan  1997 sp_m_1524    10
 3 Afghanistan  1997 sp_m_2534     6
 4 Afghanistan  1997 sp_m_3544     3
 5 Afghanistan  1997 sp_m_4554     5
 6 Afghanistan  1997 sp_m_5564     2
 7 Afghanistan  1997 sp_m_65       0
 8 Afghanistan  1997 sp_f_014      5
 9 Afghanistan  1997 sp_f_1524    38
10 Afghanistan  1997 sp_f_2534    36
# ℹ 76,036 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4">
<p>📝 Si te fijas ahora en type tenemos codificada la información como diagnosis_sexo_edad. ¿Cómo separarlo en 3 columnas? Investiga tanto <code>separate()</code> como las opciones de <code>pivot_longer()</code></p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a><span class="co"># con separate</span></span>
<span id="cb176-2"><a href="#cb176-2"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb176-3"><a href="#cb176-3"></a>  who_tidy <span class="sc">|&gt;</span> </span>
<span id="cb176-4"><a href="#cb176-4"></a>  <span class="fu">separate</span>(<span class="at">col =</span> <span class="st">"type"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"sex"</span>, <span class="st">"age"</span>))</span>
<span id="cb176-5"><a href="#cb176-5"></a></span>
<span id="cb176-6"><a href="#cb176-6"></a><span class="co"># con pivot_longer</span></span>
<span id="cb176-7"><a href="#cb176-7"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb176-8"><a href="#cb176-8"></a>  who2 <span class="sc">|&gt;</span> </span>
<span id="cb176-9"><a href="#cb176-9"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>(country<span class="sc">:</span>year),</span>
<span id="cb176-10"><a href="#cb176-10"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"sex"</span>, <span class="st">"age"</span>),</span>
<span id="cb176-11"><a href="#cb176-11"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>, <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>)</span>
<span id="cb176-12"><a href="#cb176-12"></a>who_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 76,046 × 6
   country      year diagnosis sex   age   cases
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
 1 Afghanistan  1997 sp        m     014       0
 2 Afghanistan  1997 sp        m     1524     10
 3 Afghanistan  1997 sp        m     2534      6
 4 Afghanistan  1997 sp        m     3544      3
 5 Afghanistan  1997 sp        m     4554      5
 6 Afghanistan  1997 sp        m     5564      2
 7 Afghanistan  1997 sp        m     65        0
 8 Afghanistan  1997 sp        f     014       5
 9 Afghanistan  1997 sp        f     1524     38
10 Afghanistan  1997 sp        f     2534     36
# ℹ 76,036 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-2-5">
<p>📝 Por último, separa en dos (age_inf, age_sup) el tramo etario (que sean números). Piensa cómo hacerlo ya que no siempre son 4 números</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a><span class="co"># Usamos separate y le indicamos las posiciones, pero desde atrás </span></span>
<span id="cb178-2"><a href="#cb178-2"></a><span class="co"># ya que siempre el límite superior es un número de 2 cifras</span></span>
<span id="cb178-3"><a href="#cb178-3"></a><span class="co"># y usamos convert = TRUE para convertir a números</span></span>
<span id="cb178-4"><a href="#cb178-4"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb178-5"><a href="#cb178-5"></a>  who_tidy <span class="sc">|&gt;</span> </span>
<span id="cb178-6"><a href="#cb178-6"></a>  <span class="fu">separate</span>(<span class="at">col =</span> <span class="st">"age"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"age_inf"</span>, <span class="st">"age_sup"</span>),</span>
<span id="cb178-7"><a href="#cb178-7"></a>           <span class="at">sep =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-1-2" class="slide level2">
<h2>🐣 Caso práctico II: tidydata</h2>
<p>En el fichero <code>messy_covid_data.csv</code> tienes un archivo con la cantidad de casos reportados durante la pandemia covid pero en <strong>formato messy</strong>: el nombre de las columnas codifica el sexo (H hombre, M mujer, NC no consta) y el grupo etario (0-9, 10-19, 20-29, 30-39, 40-49, 50-59, 60-69, 70-79, ≥80 años y NC no consta). Las soluciones serán asumiendo que no se conoce aún las opciones de tidyverse para modificar y filtrar tablas.</p>
<p>&nbsp;</p>
<p>Intenta responder a las preguntas planteadas en el <a href="https://javieralvarezliebana.quarto.pub/workbook-rtve/#caso-pr%C3%A1ctico-ii-covid-tidy-data"><strong>workbook</strong></a></p>
</section>
<section id="dplyr" class="slide level2">
<h2>Preprocesamiento: dplyr</h2>
<p>Como vimos dentro de <code>{tidyverse}</code> tenemos el paquete <code>{dplyr}</code> para el <span class="hl-yellow"><strong>preprocesamiento y depuración</strong></span> de los datos.</p>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/dplyr.png" width="450"></p>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb179-2"><a href="#cb179-2"></a>  <span class="fu">limpio</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-3"><a href="#cb179-3"></a>  <span class="fu">filtro</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-4"><a href="#cb179-4"></a>  <span class="fu">selecciono</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-5"><a href="#cb179-5"></a>  <span class="fu">ordeno</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-6"><a href="#cb179-6"></a>  <span class="fu">modifico</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-7"><a href="#cb179-7"></a>  <span class="fu">renombro</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-8"><a href="#cb179-8"></a>  <span class="fu">agrupo</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-9"><a href="#cb179-9"></a>  <span class="fu">cuento</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-10"><a href="#cb179-10"></a>  <span class="fu">resumo</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb179-11"><a href="#cb179-11"></a>  <span class="fu">pinto</span>(...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>La idea es que el <span class="hl-yellow"><strong>código sea legible</strong></span>, como si fuese una <strong>lista de instrucciones</strong> que al leerla nos diga de manera muy evidente lo que está haciendo.</p>
</section>
<section id="preprocesamiento-dplyr" class="slide level2">
<h2>Preprocesamiento: dplyr</h2>
<p>Vamos a repasar con el dataset <code>accidentes2020_data</code> del paquete <code>{CDR}</code> que recopila los <strong>datos de accidentes de tráfico</strong> con víctimas y/o daños al patrimonio en la ciudad de Madrid registrados por la Policía Municipal durante 2020.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a>accidentes_tb <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(CDR<span class="sc">::</span>accidentes2020_data)</span>
<span id="cb180-2"><a href="#cb180-2"></a>accidentes_tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2019S040008    07/09/2020 23:00:… CALL. SAN M… 38     CIUDAD … Choque contra…
 2 2019S040008    07/09/2020 23:00:… CALL. SAN M… 38     CIUDAD … Choque contra…
 3 2020S000001    01/01/2020 1:15:00 AVDA. CANIL… 1      SAN BLA… Colisión fron…
 4 2020S000001    01/01/2020 1:15:00 AVDA. CANIL… 1      SAN BLA… Colisión fron…
 5 2020S000002    01/01/2020 1:20:00 CALL. SILVA… 31     HORTALE… Choque contra…
 6 2020S000002    01/01/2020 1:20:00 CALL. SILVA… 31     HORTALE… Choque contra…
 7 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
 8 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
 9 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
10 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
# ℹ 32,417 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="muestreo" class="slide level2">
<h2>Muestreo</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Una de las operaciones más comunes es lo que se conoce en estadística como <span class="hl-yellow"><strong>muestreo</strong></span>: una <span class="hl-yellow"><strong>selección o filtrado de registros</strong></span> (una submuestra)</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/muestreo.jpeg" width="500"></p>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>No aleatorio (por cuotas)</strong></span>: en base a condiciones lógicas sobre los registros (<code>filter()</code>)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>No aleatorio (intencional/discreccional)</strong></span>: en base a posición (<code>slice()</code>)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Aleatorio simple</strong></span> (<code>slice_sample()</code>)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Aleatorio estratificado</strong></span> (<code>group_by()</code> + <code>slice_sample()</code>)</li>
</ul>
</div>
</section>
<section id="filtrar-filas-filter" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<p>El muestreo más simple es cuando <span class="hl-yellow"><strong>filtramos registros</strong></span> en base a alguna condición lógica: con <code>filter()</code> se seleccionarán solo individuos que cumplan ciertas condiciones</p>
<p>¿Cuáles son los <strong>accidentes que se produjeron en Carabanchel</strong>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb182-2"><a href="#cb182-2"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb182-3"><a href="#cb182-3"></a>  <span class="fu">filter</span>(distrito <span class="sc">==</span> <span class="st">"CARABANCHEL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,076 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S000006    01/01/2020 5:05:00 CALL. EUGEN… 60     CARABAN… Colisión late…
 2 2020S000006    01/01/2020 5:05:00 CALL. EUGEN… 60     CARABAN… Colisión late…
 3 2020S000006    01/01/2020 5:05:00 CALL. EUGEN… 60     CARABAN… Colisión late…
 4 2020S000006    01/01/2020 5:05:00 CALL. EUGEN… 60     CARABAN… Colisión late…
 5 2020S000020    01/01/2020 9:15:00 CALL. PARAD… 27     CARABAN… Colisión fron…
 6 2020S000020    01/01/2020 9:15:00 CALL. PARAD… 27     CARABAN… Colisión fron…
 7 2020S000020    01/01/2020 9:15:00 CALL. PARAD… 27     CARABAN… Colisión fron…
 8 2020S000035    01/01/2020 19:30:… CALL. ANTON… 3      CARABAN… Colisión fron…
 9 2020S000035    01/01/2020 19:30:… CALL. ANTON… 3      CARABAN… Colisión fron…
10 2020S000078    02/01/2020 19:30:… AVDA. CARAB… 154    CARABAN… Atropello a p…
# ℹ 2,066 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-1" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<p>¿Cuáles fueron los accidentes ocurridos el 31 de diciembre?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb184-2"><a href="#cb184-2"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb184-3"><a href="#cb184-3"></a>  <span class="fu">filter</span>(<span class="fu">as_date</span>(fecha, <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>) <span class="sc">==</span> <span class="st">"2020/12/31"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 122 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S019461    31/12/2020 0:50:00 CALL. DOCTO… 197    RETIRO   Caída         
 2 2020S019465    31/12/2020 1:15:00 AVDA. PRINC… 1      USERA    Alcance       
 3 2020S019465    31/12/2020 1:15:00 AVDA. PRINC… 1      USERA    Alcance       
 4 2020S019465    31/12/2020 1:15:00 AVDA. PRINC… 1      USERA    Alcance       
 5 2020S019466    31/12/2020 2:55:00 CALL. JORGE… 83     SALAMAN… Caída         
 6 2020S019477    31/12/2020 11:25:… CALL. VALLE… 106    CHAMBERÍ Colisión fron…
 7 2020S019477    31/12/2020 11:25:… CALL. VALLE… 106    CHAMBERÍ Colisión fron…
 8 2020S019481    31/12/2020 13:20:… CALL. MATIL… 27     CARABAN… Colisión fron…
 9 2020S019481    31/12/2020 13:20:… CALL. MATIL… 27     CARABAN… Colisión fron…
10 2020S019483    31/12/2020 13:20:… AVDA. ILUST… 0      FUENCAR… Alcance       
# ℹ 112 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-2" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<p>¿Cuáles fueron los accidentes ocurridos en diciembre en el que hay mujeres conductoras involucradas?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb186-2"><a href="#cb186-2"></a>  <span class="fu">filter</span>(<span class="fu">month</span>(<span class="fu">as_date</span>(fecha, <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>)) <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb186-3"><a href="#cb186-3"></a>           tipo_persona <span class="sc">==</span> <span class="st">"Conductor"</span> <span class="sc">&amp;</span> sexo <span class="sc">==</span> <span class="st">"Mujer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 653 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S017403    01/12/2020 9:40:00 CALL. CARTA… 88     SALAMAN… Colisión múlt…
 2 2020S017423    01/12/2020 15:05:… CALL. JUAN … 61     SALAMAN… Alcance       
 3 2020S017437    01/12/2020 15:30:… CTRA. VILLA… 269    VILLA D… Alcance       
 4 2020S017441    01/12/2020 16:10:… AUTOV. M-30… +0080… MORATAL… Alcance       
 5 2020S017441    01/12/2020 16:10:… AUTOV. M-30… +0080… MORATAL… Alcance       
 6 2020S017445    01/12/2020 19:39:… CALL. ROBER… 1D     SALAMAN… Atropello a p…
 7 2020S017446    01/12/2020 15:40:… AVDA. MEDIT… 50     RETIRO   Colisión late…
 8 2020S017448    01/12/2020 18:15:… CALL. GOYA,… 129    SALAMAN… Choque contra…
 9 2020S017454    01/12/2020 21:43:… AUTOV. M-30… +0090… RETIRO   Alcance       
10 2020S017455    01/12/2020 23:30:… AVDA. ENTRE… 2      PUENTE … Colisión fron…
# ℹ 643 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-3" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<p>¿Cuáles fueron los accidentes cuando hubo granizo, lluvia (intensa o débil) o nieve?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb188-2"><a href="#cb188-2"></a>  <span class="fu">filter</span>(estado_meteorológico <span class="sc">%in%</span></span>
<span id="cb188-3"><a href="#cb188-3"></a>           <span class="fu">c</span>(<span class="st">"Granizando"</span>, <span class="st">"LLuvia intensa"</span>, <span class="st">"Lluvia débil"</span>, <span class="st">"Nevando"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,259 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S000071    02/01/2020 17:15:… AVDA. PALOM… 60B    PUENTE … Colisión fron…
 2 2020S000071    02/01/2020 17:15:… AVDA. PALOM… 60B    PUENTE … Colisión fron…
 3 2020S000395    08/01/2020 17:30:… CTRA. VILLA… 267    VILLA D… Colisión late…
 4 2020S000395    08/01/2020 17:30:… CTRA. VILLA… 267    VILLA D… Colisión late…
 5 2020S000395    08/01/2020 17:30:… CTRA. VILLA… 267    VILLA D… Colisión late…
 6 2020S000395    08/01/2020 17:30:… CTRA. VILLA… 267    VILLA D… Colisión late…
 7 2020S001220    18/01/2020 6:55:00 PASEO. CAST… 79     TETUÁN   Atropello a p…
 8 2020S001220    18/01/2020 6:55:00 PASEO. CAST… 79     TETUÁN   Atropello a p…
 9 2020S001228    18/01/2020 8:15:00 AUTOV. A-3,… +0060… MORATAL… Solo salida d…
10 2020S001231    18/01/2020 8:50:00 AUTOV. M-30… +0300… FUENCAR… Choque contra…
# ℹ 2,249 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-4" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<p>¿Cuáles fueron los accidentes cuya lesividad se sitúa entre 1 y 3 (ambos inclusive)?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb190-2"><a href="#cb190-2"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(<span class="fu">as.numeric</span>(lesividad), <span class="dv">1</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,622 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S000007    01/01/2020 6:13:00 CALL. BOCAN… 18     SALAMAN… Colisión fron…
 2 2020S000030    01/01/2020 16:30:… AVDA. SAN D… 2      PUENTE … Colisión fron…
 3 2020S000030    01/01/2020 16:30:… AVDA. SAN D… 2      PUENTE … Colisión fron…
 4 2020S000030    01/01/2020 16:30:… AVDA. SAN D… 2      PUENTE … Colisión fron…
 5 2020S000035    01/01/2020 19:30:… CALL. ANTON… 3      CARABAN… Colisión fron…
 6 2020S000042    02/01/2020 5:00:00 AVDA. PABLO… 110    PUENTE … Colisión fron…
 7 2020S000042    02/01/2020 5:00:00 AVDA. PABLO… 110    PUENTE … Colisión fron…
 8 2020S000043    01/01/2020 14:14:… AUTOV. M-30… +0120… PUENTE … Alcance       
 9 2020S000055    02/01/2020 12:30:… CALL. SAGAS… 32     CENTRO   Colisión late…
10 2020S000064    02/01/2020 16:35:… PASEO. PONT… 22A    ARGANZU… Colisión late…
# ℹ 2,612 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtrar-filas-filter-5" class="slide level2">
<h2>Filtrar filas: filter()</h2>
<p>Las <span class="hl-yellow"><strong>condiciones lógicas</strong></span> las podemos <span class="hl-yellow"><strong>combinar</strong></span> de diferentes maneras (y, o, o excluyente)</p>

<img data-src="img/tablas_verdad.png" class="r-stretch"><div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante</strong></p>
</div>
<div class="callout-content">
<p>Recuerda que dentro de <code>filter()</code> debe ir siempre algo que devuelva un <span class="hl-green"><strong>vector de valores lógicos</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="eliminar-ausentes" class="slide level2">
<h2>Eliminar ausentes</h2>
<p>¿Cuáles fueron los accidentes en los que el sexo de la persona involucrada es desconocido?</p>
<div class="fragment">
<p>Los <span class="hl-yellow"><strong>ausentes deberían estar codificados como <code>NA</code></strong></span>, y usar <code>drop_na()</code> para depurarlos, pero no siempre van a estar ya codificados así.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb192-2"><a href="#cb192-2"></a>  <span class="fu">filter</span>(sexo <span class="sc">==</span> <span class="st">"Desconocido"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,806 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
 2 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
 3 2020S000005    01/01/2020 3:30:00 CALL. TUDES… 1      CENTRO   Colisión late…
 4 2020S000012    01/01/2020 6:40:00 AVDA. MEDIT… 10     RETIRO   Alcance       
 5 2020S000021    01/01/2020 9:30:00 CALL. LUIS … 2      PUENTE … Choque contra…
 6 2020S000032    01/01/2020 14:22:… CALL. ALFON… 1      PUENTE … Colisión late…
 7 2020S000033    01/01/2020 19:45:… CALL. OLIVA… 40     CENTRO   Choque contra…
 8 2020S000035    01/01/2020 19:30:… CALL. ANTON… 3      CARABAN… Colisión fron…
 9 2020S000039    02/01/2020 2:20:00 CALL. EJE 7… 1      VILLA D… Choque contra…
10 2020S000039    02/01/2020 2:20:00 CALL. EJE 7… 1      VILLA D… Choque contra…
# ℹ 3,796 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="rebanadas-de-datos-slice" class="slide level2">
<h2>Rebanadas de datos: slice()</h2>
<p>A veces nos puede interesar realizar un <span class="hl-yellow"><strong>muestreo no aleatorio discreccional</strong></span>, o lo que es lo mismo, <span class="hl-yellow"><strong>filtrar por posición</strong></span>: con <code>slice(posiciones)</code> podremos seleccionar filas concretas pasando como argumento un <span class="hl-yellow"><strong>vector de índices</strong></span></p>
<p>¿Cuáles son los <strong>7 primeros accidentes guardados</strong> en la base de datos?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb194-2"><a href="#cb194-2"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 17
  num_expediente fecha      hora     localizacion numero distrito tipo_accidente
  &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
1 2019S040008    07/09/2020 23:00:00 CALL. SAN M… 38     CIUDAD … Choque contra…
2 2019S040008    07/09/2020 23:00:00 CALL. SAN M… 38     CIUDAD … Choque contra…
3 2020S000001    01/01/2020 1:15:00  AVDA. CANIL… 1      SAN BLA… Colisión fron…
4 2020S000001    01/01/2020 1:15:00  AVDA. CANIL… 1      SAN BLA… Colisión fron…
5 2020S000002    01/01/2020 1:20:00  CALL. SILVA… 31     HORTALE… Choque contra…
6 2020S000002    01/01/2020 1:20:00  CALL. SILVA… 31     HORTALE… Choque contra…
7 2020S000003    01/01/2020 2:00:00  CALL. BRAVO… 1      CHAMBERÍ Alcance       
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a><span class="co"># otra forma:</span></span>
<span id="cb196-2"><a href="#cb196-2"></a><span class="co"># accidentes_tb |&gt; </span></span>
<span id="cb196-3"><a href="#cb196-3"></a><span class="co">#   slice_head(n = 7)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="rebanadas-de-datos-slice-1" class="slide level2">
<h2>Rebanadas de datos: slice()</h2>
<p>¿Cuáles fueron los <strong>primeros 100 accidentes</strong> del año (usando fecha y hora)?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb197-2"><a href="#cb197-2"></a>  <span class="fu">slice_min</span>(<span class="fu">dmy_hms</span>(<span class="fu">paste</span>(fecha, hora)), <span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
 2 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
 3 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
 4 2020S000014    01/01/2020 1:00:00 PLAZA. CIBE… 1      RETIRO   Colisión fron…
 5 2020S000014    01/01/2020 1:00:00 PLAZA. CIBE… 1      RETIRO   Colisión fron…
 6 2020S000001    01/01/2020 1:15:00 AVDA. CANIL… 1      SAN BLA… Colisión fron…
 7 2020S000001    01/01/2020 1:15:00 AVDA. CANIL… 1      SAN BLA… Colisión fron…
 8 2020S000002    01/01/2020 1:20:00 CALL. SILVA… 31     HORTALE… Choque contra…
 9 2020S000002    01/01/2020 1:20:00 CALL. SILVA… 31     HORTALE… Choque contra…
10 2020S000037    01/01/2020 1:55:00 AVDA. OROVI… 32     VILLAVE… Colisión fron…
# ℹ 90 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="rebanadas-de-datos-slice-2" class="slide level2">
<h2>Rebanadas de datos: slice()</h2>
<p>¿Cuáles fue el <strong>último accidente</strong> del año (usando fecha y hora)?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb199-2"><a href="#cb199-2"></a>  <span class="fu">slice_max</span>(<span class="fu">dmy_hms</span>(<span class="fu">paste</span>(fecha, hora)), <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 17
  num_expediente fecha      hora     localizacion numero distrito tipo_accidente
  &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
1 2020S019515    31/12/2020 22:30:00 CTRA. VICAL… 14     PUENTE … Choque contra…
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="aleatorio-slice_sample" class="slide level2">
<h2>Aleatorio: slice_sample()</h2>
<p>El conocido como <span class="hl-yellow"><strong>muestreo aleatorio simple</strong></span> se basa en <span class="hl-yellow"><strong>seleccionar individuos aleatoriamente</strong></span>, de forma que cada uno tenga ciertas <span class="hl-yellow"><strong>probabilidades</strong></span> de ser seleccionado. Con <code>slice_sample(n = ...)</code> o <code>slice_sample(prop = ...)</code> podemos extraer n registros aleatoriamente (a priori equiprobables).</p>
<p><strong>Extrae el 10%</strong> de la muestra de manera aleatoria</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb201-2"><a href="#cb201-2"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,242 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S004586    28/02/2020 18:00:… AVDA. INSTI… 14     CIUDAD … Caída         
 2 2020S007304    26/05/2020 21:30:… CALL. CARTA… 40     SALAMAN… Colisión fron…
 3 2020S017658    04/12/2020 20:00:… AVDA. ALBUF… 281    PUENTE … Colisión late…
 4 2020S007681    02/06/2020 21:20:… CTRA. RODAJ… 2      MONCLOA… Caída         
 5 2020S018071    09/12/2020 21:20:… CALL. CLARA… 3      CHAMART… Colisión fron…
 6 2020S003225    07/02/2020 20:30:… CALL. OCAÑA… 106    LATINA   Alcance       
 7 2020S003019    09/02/2020 3:40:00 CALL. SAN B… 62     CENTRO   Atropello a p…
 8 2020S002018    27/01/2020 19:16:… PLAZA. COLO… 1      CENTRO   Colisión late…
 9 2020S016938    24/11/2020 23:14:… CALL. LOPEZ… 1      SALAMAN… Choque contra…
10 2020S002222    29/01/2020 19:25:… AVDA. GALAX… 1      MONCLOA… Colisión fron…
# ℹ 3,232 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="aleatorio-slice_sample-1" class="slide level2">
<h2>Aleatorio: slice_sample()</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante…</strong></p>
</div>
<div class="callout-content">
<p><span class="hl-yellow"><strong>«Aleatorio» no implica equiprobable</strong></span>: es igual de aleatorio un dado normal que uno trucado. No hay cosas «más aleatorias» que otras, simplemente tienen subyacente distintas leyes de probabilidad.</p>
</div>
</div>
</div>
<p><strong>Extrae el 10% de la muestra de manera aleatoria pero</strong> siendo más probable de muestrear a los accidentes en los primeros días de mes</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb203-2"><a href="#cb203-2"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.1</span>, <span class="at">weight_by =</span> <span class="fu">day</span>(<span class="fu">dmy</span>(fecha)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,242 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S014625    19/10/2020 6:45:00 PLAZA. ESPA… 1      CENTRO   Alcance       
 2 2020S014937    23/10/2020 18:30:… PASEO. CAST… 63     CHAMBERÍ Alcance       
 3 2020S011488    21/08/2020 14:33:… CALL. VIRGE… 19     CIUDAD … Colisión fron…
 4 2020S007005    19/05/2020 23:50:… CALL. RAMON… 161    FUENCAR… Choque contra…
 5 2020S009107    30/06/2020 18:20:… M-30 CALZAD… +0090… RETIRO   Colisión múlt…
 6 2020S016630    20/11/2020 16:00:… CALL. RAMIR… 11     MONCLOA… Choque contra…
 7 2020S018889    19/12/2020 21:15:… AUTOV. A-3 … +0050… MORATAL… Choque contra…
 8 2020S002466    02/02/2020 18:00:… CALL. VALLE… 1      FUENCAR… Choque contra…
 9 2020S007600    30/05/2020 11:30:… AVDA. GRAN … 4      VICÁLVA… Alcance       
10 2020S001202    18/01/2020 2:55:00 CALL. FRANC… 50     SALAMAN… Colisión late…
# ℹ 3,232 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="reordenar-filas-arrange" class="slide level2">
<h2>Reordenar filas: arrange()</h2>
<p>También podemos <span class="hl-yellow"><strong>ordenar filas</strong></span> en función de alguna variable con <code>arrange()</code></p>
<p><strong>Ordena</strong> los accidentes por fecha</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb205-2"><a href="#cb205-2"></a>  <span class="fu">arrange</span>(<span class="fu">dmy</span>(fecha))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2020S000001    01/01/2020 1:15:00 AVDA. CANIL… 1      SAN BLA… Colisión fron…
 2 2020S000001    01/01/2020 1:15:00 AVDA. CANIL… 1      SAN BLA… Colisión fron…
 3 2020S000002    01/01/2020 1:20:00 CALL. SILVA… 31     HORTALE… Choque contra…
 4 2020S000002    01/01/2020 1:20:00 CALL. SILVA… 31     HORTALE… Choque contra…
 5 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
 6 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
 7 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
 8 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
 9 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
10 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
# ℹ 32,417 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="eliminar-duplicados-distinct" class="slide level2">
<h2>Eliminar duplicados: distinct()</h2>
<p>Muchas veces necesitaremos asegurarnos que no hay duplicados en alguna variable y podemos <span class="hl-yellow"><strong>eliminar filas duplicadas</strong></span> con <code>distinct()</code>.</p>
<p><strong>Elimina los duplicados</strong> considerando duplicados aquellos registros con mismo <code>num_expediente</code>, mismo <code>tipo_accidente</code> y mismo <code>tipo_persona</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a>accidentes_tb <span class="sc">|&gt;</span></span>
<span id="cb207-2"><a href="#cb207-2"></a>  <span class="fu">distinct</span>(num_expediente, tipo_accidente, tipo_persona)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18,346 × 3
   num_expediente tipo_accidente               tipo_persona
   &lt;chr&gt;          &lt;chr&gt;                        &lt;chr&gt;       
 1 2019S040008    Choque contra obstáculo fijo Conductor   
 2 2020S000001    Colisión fronto-lateral      Conductor   
 3 2020S000002    Choque contra obstáculo fijo Conductor   
 4 2020S000002    Choque contra obstáculo fijo Pasajero    
 5 2020S000003    Alcance                      Conductor   
 6 2020S000003    Alcance                      Pasajero    
 7 2020S000004    Choque contra obstáculo fijo Conductor   
 8 2020S000005    Colisión lateral             Conductor   
 9 2020S000006    Colisión lateral             Conductor   
10 2020S000006    Colisión lateral             Pasajero    
# ℹ 18,336 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="selección-columnas-select" class="slide level2">
<h2>Selección columnas: select()</h2>
<p>Hasta ahora todas las operaciones realizadas (aunque usásemos info de columnas) eran por filas. En el caso de columnas, la acción más sencilla es <span class="hl-yellow"><strong>seleccionar variables por nombre</strong></span> con <code>select()</code>, dando como argumentos los nombres de columnas <span class="hl-purple"><strong>sin comillas</strong></span>.</p>
<p><strong>Selecciona solo las columnas</strong> <code>num_expediente</code>, <code>fecha</code>, <code>hora</code>, <code>distrito</code>, <code>tipo_persona</code>, <code>rango_edad</code> y <code>sexo</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb209-2"><a href="#cb209-2"></a>  <span class="fu">select</span>(num_expediente<span class="sc">:</span>hora, distrito, tipo_persona<span class="sc">:</span>sexo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 7
   num_expediente fecha      hora     distrito     tipo_persona rango_edad sexo 
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;
 1 2019S040008    07/09/2020 23:00:00 CIUDAD LINE… Conductor    De 21 a 2… Homb…
 2 2019S040008    07/09/2020 23:00:00 CIUDAD LINE… Conductor    De 25 a 2… Mujer
 3 2020S000001    01/01/2020 1:15:00  SAN BLAS-CA… Conductor    De 18 a 2… Homb…
 4 2020S000001    01/01/2020 1:15:00  SAN BLAS-CA… Conductor    De 30 a 3… Homb…
 5 2020S000002    01/01/2020 1:20:00  HORTALEZA    Conductor    De 21 a 2… Homb…
 6 2020S000002    01/01/2020 1:20:00  HORTALEZA    Pasajero     De 40 a 4… Homb…
 7 2020S000003    01/01/2020 2:00:00  CHAMBERÍ     Conductor    De 40 a 4… Homb…
 8 2020S000003    01/01/2020 2:00:00  CHAMBERÍ     Conductor    De 70 a 7… Homb…
 9 2020S000003    01/01/2020 2:00:00  CHAMBERÍ     Pasajero     De 40 a 4… Mujer
10 2020S000004    01/01/2020 1:00:00  CIUDAD LINE… Conductor    Desconoci… Desc…
# ℹ 32,417 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="selección-columnas-select-1" class="slide level2">
<h2>Selección columnas: select()</h2>
<p><strong>Elimina la columna</strong> <code>localizacion</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb211-2"><a href="#cb211-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>localizacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 16
   num_expediente fecha      hora     numero distrito            tipo_accidente 
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;               &lt;chr&gt;          
 1 2019S040008    07/09/2020 23:00:00 38     CIUDAD LINEAL       Choque contra …
 2 2019S040008    07/09/2020 23:00:00 38     CIUDAD LINEAL       Choque contra …
 3 2020S000001    01/01/2020 1:15:00  1      SAN BLAS-CANILLEJAS Colisión front…
 4 2020S000001    01/01/2020 1:15:00  1      SAN BLAS-CANILLEJAS Colisión front…
 5 2020S000002    01/01/2020 1:20:00  31     HORTALEZA           Choque contra …
 6 2020S000002    01/01/2020 1:20:00  31     HORTALEZA           Choque contra …
 7 2020S000003    01/01/2020 2:00:00  1      CHAMBERÍ            Alcance        
 8 2020S000003    01/01/2020 2:00:00  1      CHAMBERÍ            Alcance        
 9 2020S000003    01/01/2020 2:00:00  1      CHAMBERÍ            Alcance        
10 2020S000004    01/01/2020 1:00:00  5      CIUDAD LINEAL       Choque contra …
# ℹ 32,417 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="selección-columnas-select-2" class="slide level2">
<h2>Selección columnas: select()</h2>
<p>También podemos jugar con <span class="hl-yellow"><strong>patrones</strong></span> en el nombre, aquellas que <span class="hl-purple"><strong>comiencen/termina por un patrón</strong></span>, que lo contengan o que cumplan una <span class="hl-purple"><strong>expresión regular</strong></span> (<code>matches()</code>).</p>
<p><strong>Selecciona las columnas</strong> <code>num_expediente</code>, <code>fecha</code>, <code>hora</code> y aquellas que apelen a coordenas o a <code>tipo_</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb213-2"><a href="#cb213-2"></a>  <span class="fu">select</span>(num_expediente, fecha, hora, <span class="fu">starts_with</span>(<span class="st">"coordenada"</span>), </span>
<span id="cb213-3"><a href="#cb213-3"></a>         <span class="fu">starts_with</span>(<span class="st">"tipo_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 8
   num_expediente fecha   hora  coordenada_x_utm coordenada_y_utm tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;            &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;         
 1 2019S040008    07/09/… 23:0…          444598.         4475156. Choque contra…
 2 2019S040008    07/09/… 23:0…          444598.         4475156. Choque contra…
 3 2020S000001    01/01/… 1:15…          447711.         4477156. Colisión fron…
 4 2020S000001    01/01/… 1:15…          447711.         4477156. Colisión fron…
 5 2020S000002    01/01/… 1:20…          445076.         4478372. Choque contra…
 6 2020S000002    01/01/… 1:20…          445076.         4478372. Choque contra…
 7 2020S000003    01/01/… 2:00…          440243.         4476174. Alcance       
 8 2020S000003    01/01/… 2:00…          440243.         4476174. Alcance       
 9 2020S000003    01/01/… 2:00…          440243.         4476174. Alcance       
10 2020S000004    01/01/… 1:00…          445416.         4476670. Choque contra…
# ℹ 32,417 more rows
# ℹ 2 more variables: tipo_vehiculo &lt;chr&gt;, tipo_persona &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="selección-columnas-select-3" class="slide level2">
<h2>Selección columnas: select()</h2>
<p>También podemos seleccionar columnas por <span class="hl-yellow"><strong>tipo de dato</strong></span> haciendo uso de <code>where()</code> y dentro una función que devuelva un valor lógico de tipo de dato.</p>
<p><strong>Selecciona las columnas</strong> de tipo character.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb215-2"><a href="#cb215-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 15
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2019S040008    07/09/2020 23:00:… CALL. SAN M… 38     CIUDAD … Choque contra…
 2 2019S040008    07/09/2020 23:00:… CALL. SAN M… 38     CIUDAD … Choque contra…
 3 2020S000001    01/01/2020 1:15:00 AVDA. CANIL… 1      SAN BLA… Colisión fron…
 4 2020S000001    01/01/2020 1:15:00 AVDA. CANIL… 1      SAN BLA… Colisión fron…
 5 2020S000002    01/01/2020 1:20:00 CALL. SILVA… 31     HORTALE… Choque contra…
 6 2020S000002    01/01/2020 1:20:00 CALL. SILVA… 31     HORTALE… Choque contra…
 7 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
 8 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
 9 2020S000003    01/01/2020 2:00:00 CALL. BRAVO… 1      CHAMBERÍ Alcance       
10 2020S000004    01/01/2020 1:00:00 CALL. MANDA… 5      CIUDAD … Choque contra…
# ℹ 32,417 more rows
# ℹ 8 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   positiva_alcohol &lt;chr&gt;, positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="renombrar-rename" class="slide level2">
<h2>Renombrar: rename()</h2>
<p>A veces también podemos querer <span class="hl-yellow"><strong>modificar la «metainformación»</strong></span> de los datos, <span class="hl-yellow"><strong>renombrando columnas</strong></span>. Para ello usaremos de <code>rename()</code> poniendo <span class="hl-purple"><strong>primero el nombre nuevo</strong></span> y luego el <span class="hl-purple"><strong>antiguo</strong></span>.</p>
<p><strong>Renombra las columnas</strong> <code>num_expediente</code> como <code>numero_exp</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb217-2"><a href="#cb217-2"></a>  <span class="fu">rename</span>(<span class="at">numero_exp =</span> num_expediente)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 17
   numero_exp  fecha      hora     localizacion   numero distrito tipo_accidente
   &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         
 1 2019S040008 07/09/2020 23:00:00 CALL. SAN MAX… 38     CIUDAD … Choque contra…
 2 2019S040008 07/09/2020 23:00:00 CALL. SAN MAX… 38     CIUDAD … Choque contra…
 3 2020S000001 01/01/2020 1:15:00  AVDA. CANILLE… 1      SAN BLA… Colisión fron…
 4 2020S000001 01/01/2020 1:15:00  AVDA. CANILLE… 1      SAN BLA… Colisión fron…
 5 2020S000002 01/01/2020 1:20:00  CALL. SILVANO… 31     HORTALE… Choque contra…
 6 2020S000002 01/01/2020 1:20:00  CALL. SILVANO… 31     HORTALE… Choque contra…
 7 2020S000003 01/01/2020 2:00:00  CALL. BRAVO M… 1      CHAMBERÍ Alcance       
 8 2020S000003 01/01/2020 2:00:00  CALL. BRAVO M… 1      CHAMBERÍ Alcance       
 9 2020S000003 01/01/2020 2:00:00  CALL. BRAVO M… 1      CHAMBERÍ Alcance       
10 2020S000004 01/01/2020 1:00:00  CALL. MANDARI… 5      CIUDAD … Choque contra…
# ℹ 32,417 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="modificar-columnas-mutate" class="slide level2">
<h2>Modificar columnas: mutate()</h2>
<p>En muchas ocasiones querremos <span class="hl-yellow"><strong>modificar o crear variables</strong></span> con <code>mutate()</code>.</p>
<p>Haciendo uso de las funciones de <code>{lubridate}</code> <strong>crea una nueva columna</strong> llamada <code>fecha_hora</code> que guarde la fecha y hora en un formato fecha-hora (<code>datetime</code>) y elimina dichas variables originales</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb219-2"><a href="#cb219-2"></a>  <span class="fu">mutate</span>(<span class="st">"fecha_hora"</span> <span class="ot">=</span> <span class="fu">dmy_hms</span>(<span class="fu">paste</span>(fecha, hora)), <span class="at">.after =</span> num_expediente) <span class="sc">|&gt;</span> </span>
<span id="cb219-3"><a href="#cb219-3"></a>  <span class="fu">select</span>(<span class="sc">-</span>fecha, <span class="sc">-</span>hora)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 16
   num_expediente fecha_hora          localizacion               numero distrito
   &lt;chr&gt;          &lt;dttm&gt;              &lt;chr&gt;                      &lt;chr&gt;  &lt;chr&gt;   
 1 2019S040008    2020-09-07 23:00:00 CALL. SAN MAXIMILIANO, 38  38     CIUDAD …
 2 2019S040008    2020-09-07 23:00:00 CALL. SAN MAXIMILIANO, 38  38     CIUDAD …
 3 2020S000001    2020-01-01 01:15:00 AVDA. CANILLEJAS A VICALV… 1      SAN BLA…
 4 2020S000001    2020-01-01 01:15:00 AVDA. CANILLEJAS A VICALV… 1      SAN BLA…
 5 2020S000002    2020-01-01 01:20:00 CALL. SILVANO, 31          31     HORTALE…
 6 2020S000002    2020-01-01 01:20:00 CALL. SILVANO, 31          31     HORTALE…
 7 2020S000003    2020-01-01 02:00:00 CALL. BRAVO MURILLO, 1     1      CHAMBERÍ
 8 2020S000003    2020-01-01 02:00:00 CALL. BRAVO MURILLO, 1     1      CHAMBERÍ
 9 2020S000003    2020-01-01 02:00:00 CALL. BRAVO MURILLO, 1     1      CHAMBERÍ
10 2020S000004    2020-01-01 01:00:00 CALL. MANDARINA, 5         5      CIUDAD …
# ℹ 32,417 more rows
# ℹ 11 more variables: tipo_accidente &lt;chr&gt;, estado_meteorológico &lt;chr&gt;,
#   tipo_vehiculo &lt;chr&gt;, tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;,
#   lesividad &lt;chr&gt;, coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;,
#   positiva_alcohol &lt;chr&gt;, positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="modificar-columnas-mutate-1" class="slide level2">
<h2>Modificar columnas: mutate()</h2>
<p><strong>Modifica la columna</strong> <code>numero</code> que ya existe para convertirla a tipo numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a>accidentes_tb <span class="ot">&lt;-</span></span>
<span id="cb221-2"><a href="#cb221-2"></a>  accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb221-3"><a href="#cb221-3"></a>  <span class="fu">mutate</span>(<span class="st">"numero"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(numero))</span>
<span id="cb221-4"><a href="#cb221-4"></a>accidentes_tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;         
 1 2019S040008    07/09/2020 23:00:… CALL. SAN M…     38 CIUDAD … Choque contra…
 2 2019S040008    07/09/2020 23:00:… CALL. SAN M…     38 CIUDAD … Choque contra…
 3 2020S000001    01/01/2020 1:15:00 AVDA. CANIL…      1 SAN BLA… Colisión fron…
 4 2020S000001    01/01/2020 1:15:00 AVDA. CANIL…      1 SAN BLA… Colisión fron…
 5 2020S000002    01/01/2020 1:20:00 CALL. SILVA…     31 HORTALE… Choque contra…
 6 2020S000002    01/01/2020 1:20:00 CALL. SILVA…     31 HORTALE… Choque contra…
 7 2020S000003    01/01/2020 2:00:00 CALL. BRAVO…      1 CHAMBERÍ Alcance       
 8 2020S000003    01/01/2020 2:00:00 CALL. BRAVO…      1 CHAMBERÍ Alcance       
 9 2020S000003    01/01/2020 2:00:00 CALL. BRAVO…      1 CHAMBERÍ Alcance       
10 2020S000004    01/01/2020 1:00:00 CALL. MANDA…      5 CIUDAD … Choque contra…
# ℹ 32,417 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="modificar-columnas-mutate-2" class="slide level2">
<h2>Modificar columnas: mutate()</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante…</strong></p>
</div>
<div class="callout-content">
<p>Cuando aplicamos <code>mutate()</code>, debemos de acordarnos que las <span class="hl-yellow"><strong>operaciones se realizan de manera vectorial</strong></span>, elemento a elemento, por lo que la función que usemos dentro debe devolver un vector de igual longitud. En caso contrario, <span class="hl-red"><strong>devolverá una constante</strong></span></p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb223-2"><a href="#cb223-2"></a>  <span class="fu">mutate</span>(<span class="st">"dummy"</span> <span class="ot">=</span> <span class="fu">mean</span>(numero, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb223-3"><a href="#cb223-3"></a>         <span class="at">.before =</span> <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 18
   dummy num_expediente fecha  hora  localizacion numero distrito tipo_accidente
   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;         
 1  104. 2019S040008    07/09… 23:0… CALL. SAN M…     38 CIUDAD … Choque contra…
 2  104. 2019S040008    07/09… 23:0… CALL. SAN M…     38 CIUDAD … Choque contra…
 3  104. 2020S000001    01/01… 1:15… AVDA. CANIL…      1 SAN BLA… Colisión fron…
 4  104. 2020S000001    01/01… 1:15… AVDA. CANIL…      1 SAN BLA… Colisión fron…
 5  104. 2020S000002    01/01… 1:20… CALL. SILVA…     31 HORTALE… Choque contra…
 6  104. 2020S000002    01/01… 1:20… CALL. SILVA…     31 HORTALE… Choque contra…
 7  104. 2020S000003    01/01… 2:00… CALL. BRAVO…      1 CHAMBERÍ Alcance       
 8  104. 2020S000003    01/01… 2:00… CALL. BRAVO…      1 CHAMBERÍ Alcance       
 9  104. 2020S000003    01/01… 2:00… CALL. BRAVO…      1 CHAMBERÍ Alcance       
10  104. 2020S000004    01/01… 1:00… CALL. MANDA…      5 CIUDAD … Choque contra…
# ℹ 32,417 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="recategorizar" class="slide level2">
<h2>Recategorizar</h2>
<p><strong>Recodifica</strong> la variable sexo tal que si no se conoce su valor se incluye <code>NA</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb225-2"><a href="#cb225-2"></a>  <span class="fu">mutate</span>(<span class="st">"sexo"</span> <span class="ot">=</span> <span class="fu">if_else</span>(sexo <span class="sc">==</span> <span class="st">"Desconocido"</span>, <span class="cn">NA</span>, sexo)) <span class="sc">|&gt;</span> </span>
<span id="cb225-3"><a href="#cb225-3"></a>  <span class="fu">select</span>(num_expediente, sexo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 2
   num_expediente sexo  
   &lt;chr&gt;          &lt;chr&gt; 
 1 2019S040008    Hombre
 2 2019S040008    Mujer 
 3 2020S000001    Hombre
 4 2020S000001    Hombre
 5 2020S000002    Hombre
 6 2020S000002    Hombre
 7 2020S000003    Hombre
 8 2020S000003    Hombre
 9 2020S000003    Mujer 
10 2020S000004    &lt;NA&gt;  
# ℹ 32,417 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="recategorizar-1" class="slide level2">
<h2>Recategorizar</h2>
<p><strong>Recodifica</strong> la variable <code>estado_meteorológico</code> para dejar solo <code>"Despejado"</code>, <code>"Precipitación"</code> (incluye lluvia, nieve, granizo), <code>"Nublado"</code> y <code>NA</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb227-2"><a href="#cb227-2"></a>  <span class="fu">mutate</span>(<span class="st">"estado_meteorológico"</span> <span class="ot">=</span></span>
<span id="cb227-3"><a href="#cb227-3"></a>           <span class="fu">case_when</span>(estado_meteorológico <span class="sc">==</span> <span class="st">"Despejado"</span> <span class="sc">~</span> <span class="st">"Despejado"</span>,</span>
<span id="cb227-4"><a href="#cb227-4"></a>                     estado_meteorológico <span class="sc">%in%</span></span>
<span id="cb227-5"><a href="#cb227-5"></a>                       <span class="fu">c</span>(<span class="st">"Granizando"</span>, <span class="st">"Lluvia intensa"</span>,</span>
<span id="cb227-6"><a href="#cb227-6"></a>                         <span class="st">"Lluvia débil"</span>, <span class="st">"Nevando"</span>) <span class="sc">~</span> <span class="st">"Precipitación"</span>,</span>
<span id="cb227-7"><a href="#cb227-7"></a>                     estado_meteorológico <span class="sc">==</span> <span class="st">"Nublado"</span> <span class="sc">~</span> <span class="st">"Nublado"</span>,</span>
<span id="cb227-8"><a href="#cb227-8"></a>                     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb227-9"><a href="#cb227-9"></a>  <span class="fu">select</span>(num_expediente, estado_meteorológico)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,427 × 2
   num_expediente estado_meteorológico
   &lt;chr&gt;          &lt;chr&gt;               
 1 2019S040008    Despejado           
 2 2019S040008    Despejado           
 3 2020S000001    &lt;NA&gt;                
 4 2020S000001    &lt;NA&gt;                
 5 2020S000002    Despejado           
 6 2020S000002    Despejado           
 7 2020S000003    Despejado           
 8 2020S000003    Despejado           
 9 2020S000003    Despejado           
10 2020S000004    Despejado           
# ℹ 32,417 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="contar-count" class="slide level2">
<h2>Contar: count()</h2>
<p>Hasta ahora solo hemos transformado o consultado los datos pero no hemos generado estadísticas. Empecemos por lo sencillo: <span class="hl-yellow"><strong>¿cómo contar (frecuencias)?</strong></span></p>
<p>¿Cuántos accidentes hay guardados de cada sexo?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb229-2"><a href="#cb229-2"></a>  <span class="fu">count</span>(sexo, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  sexo            n
  &lt;chr&gt;       &lt;int&gt;
1 Hombre      19627
2 Mujer        8994
3 Desconocido  3806</code></pre>
</div>
</div>
</div>
</section>
<section id="contar-count-1" class="slide level2">
<h2>Contar: count()</h2>
<p>¿Qué % del total representa cada sexo?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb231-2"><a href="#cb231-2"></a>  <span class="fu">count</span>(sexo, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb231-3"><a href="#cb231-3"></a>  <span class="fu">mutate</span>(<span class="st">"prop"</span> <span class="ot">=</span> n<span class="sc">/</span><span class="fu">sum</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  sexo            n  prop
  &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt;
1 Hombre      19627 0.605
2 Mujer        8994 0.277
3 Desconocido  3806 0.117</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1"></a><span class="co"># modo R base</span></span>
<span id="cb233-2"><a href="#cb233-2"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(accidentes_tb<span class="sc">$</span>sexo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Desconocido      Hombre       Mujer 
  0.1173713   0.6052672   0.2773615 </code></pre>
</div>
</div>
</div>
</section>
<section id="contar-count-2" class="slide level2">
<h2>Contar: count()</h2>
<p>¿Cuántos accidentes hubo para cada sexo y cada tipo de persona (conductor, peatón, etc)?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb235-2"><a href="#cb235-2"></a>  <span class="fu">count</span>(sexo, tipo_persona, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  sexo        tipo_persona     n
  &lt;chr&gt;       &lt;chr&gt;        &lt;int&gt;
1 Hombre      Conductor    17034
2 Mujer       Conductor     5688
3 Desconocido Conductor     3801
4 Mujer       Pasajero      2745
5 Hombre      Pasajero      2055
6 Mujer       Peatón         561
7 Hombre      Peatón         538
8 Desconocido Peatón           5</code></pre>
</div>
</div>
</div>
</section>
<section id="agrupar-group_by" class="slide level2">
<h2>Agrupar: group_by()</h2>
<p>¿Cuál fueron los primeros accidente del año por cada sexo?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb237-2"><a href="#cb237-2"></a>  <span class="fu">slice_min</span>(<span class="fu">dmy_hms</span>(<span class="fu">paste</span>(fecha, hora)), <span class="at">n =</span> <span class="dv">1</span>, <span class="at">by =</span> sexo,</span>
<span id="cb237-3"><a href="#cb237-3"></a>            <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 17
  num_expediente fecha      hora    localizacion  numero distrito tipo_accidente
  &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;         
1 2020S000004    01/01/2020 1:00:00 CALL. MANDAR…      5 CIUDAD … Choque contra…
2 2020S000037    01/01/2020 1:55:00 AVDA. OROVIL…     32 VILLAVE… Colisión fron…
3 2020S000004    01/01/2020 1:00:00 CALL. MANDAR…      5 CIUDAD … Choque contra…
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="agrupar-group_by-1" class="slide level2">
<h2>Agrupar: group_by()</h2>
<p>Cuando apliquemos <code>group_by()</code> es importante entender que <span class="hl-yellow"><strong>NO MODIFICA los datos</strong></span>, sino que nos crea una <span class="hl-yellow"><strong>variable de grupo</strong></span> que modificará las acciones futuras.</p>
<p>¿Cuál fue el accidente más lesivo por cada tipo de persona y sexo?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb239-2"><a href="#cb239-2"></a>  <span class="fu">slice_max</span>(lesividad, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fu">c</span>(sexo, tipo_persona))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14,796 × 17
   num_expediente fecha      hora    localizacion numero distrito tipo_accidente
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;         
 1 2019S040008    07/09/2020 23:00:… CALL. SAN M…     38 CIUDAD … Choque contra…
 2 2020S000001    01/01/2020 1:15:00 AVDA. CANIL…      1 SAN BLA… Colisión fron…
 3 2020S000001    01/01/2020 1:15:00 AVDA. CANIL…      1 SAN BLA… Colisión fron…
 4 2020S000002    01/01/2020 1:20:00 CALL. SILVA…     31 HORTALE… Choque contra…
 5 2020S000003    01/01/2020 2:00:00 CALL. BRAVO…      1 CHAMBERÍ Alcance       
 6 2020S000003    01/01/2020 2:00:00 CALL. BRAVO…      1 CHAMBERÍ Alcance       
 7 2020S000004    01/01/2020 1:00:00 CALL. MANDA…      5 CIUDAD … Choque contra…
 8 2020S000006    01/01/2020 5:05:00 CALL. EUGEN…     60 CARABAN… Colisión late…
 9 2020S000009    01/01/2020 7:10:00 CALL. FRANC…     44 SALAMAN… Colisión fron…
10 2020S000009    01/01/2020 7:10:00 CALL. FRANC…     44 SALAMAN… Colisión fron…
# ℹ 14,786 more rows
# ℹ 10 more variables: estado_meteorológico &lt;chr&gt;, tipo_vehiculo &lt;chr&gt;,
#   tipo_persona &lt;chr&gt;, rango_edad &lt;chr&gt;, sexo &lt;chr&gt;, lesividad &lt;chr&gt;,
#   coordenada_x_utm &lt;dbl&gt;, coordenada_y_utm &lt;dbl&gt;, positiva_alcohol &lt;chr&gt;,
#   positiva_droga &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="resumir-summarise" class="slide level2">
<h2>Resumir: summarise()</h2>
<p>Por último tenemos <code>summarise()</code>, que nos permitirá sacar resúmenes estadísticos.</p>
<p><strong>Calcula la media</strong> de accidentes diarios por sexo</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb241-2"><a href="#cb241-2"></a>  <span class="fu">count</span>(sexo, fecha) <span class="sc">|&gt;</span> </span>
<span id="cb241-3"><a href="#cb241-3"></a>  <span class="fu">summarise</span>(<span class="st">"media_diaria"</span> <span class="ot">=</span> <span class="fu">mean</span>(n), <span class="at">.by =</span> sexo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  sexo        media_diaria
  &lt;chr&gt;              &lt;dbl&gt;
1 Desconocido         10.7
2 Hombre              53.6
3 Mujer               24.9</code></pre>
</div>
</div>
</div>
</section>
<section id="resumir-summarise-1" class="slide level2">
<h2>Resumir: summarise()</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Cuidado</strong></p>
</div>
<div class="callout-content">
<p>Fíjate que <code>mutate()</code> devuelve <span class="hl-yellow"><strong>tantas filas como registros originales</strong></span>, mientras que con <code>summarise()</code> calcula un <span class="hl-purple"><strong>nuevo dataset de resumen</strong></span>, solo incluyendo aquello que esté indicado.</p>
</div>
</div>
</div>
<p><strong>Calcula la media de lesividad</strong> de los accidentes por tipo de persona</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a>accidentes_tb <span class="sc">|&gt;</span></span>
<span id="cb243-2"><a href="#cb243-2"></a>  <span class="fu">mutate</span>(<span class="st">"lesividad"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(lesividad)) <span class="sc">|&gt;</span> </span>
<span id="cb243-3"><a href="#cb243-3"></a>  <span class="fu">drop_na</span>(lesividad) <span class="sc">|&gt;</span> </span>
<span id="cb243-4"><a href="#cb243-4"></a>  <span class="fu">summarise</span>(<span class="st">"media_lesividad"</span> <span class="ot">=</span> <span class="fu">mean</span>(lesividad), <span class="at">.by =</span> tipo_persona)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  tipo_persona media_lesividad
  &lt;chr&gt;                  &lt;dbl&gt;
1 Pasajero               10.1 
2 Conductor              10.1 
3 Peatón                  5.48</code></pre>
</div>
</div>
</div>
</section>
<section id="resumir-reframe" class="slide level2">
<h2>Resumir: reframe()</h2>
<p>En el nuevo <code>{dplyr}</code> han incluido <code>reframe()</code> para evitar problemas de <code>summarise()</code> cuando <span class="hl-yellow"><strong>devolvemos más de un valor por variable</strong></span>.</p>
<p><strong>Calcula los cuartiles de la variables lesividad</strong></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb245-2"><a href="#cb245-2"></a>  <span class="fu">mutate</span>(<span class="st">"lesividad"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(lesividad)) <span class="sc">|&gt;</span> </span>
<span id="cb245-3"><a href="#cb245-3"></a>  <span class="fu">drop_na</span>(lesividad) <span class="sc">|&gt;</span> </span>
<span id="cb245-4"><a href="#cb245-4"></a>  <span class="fu">reframe</span>(<span class="fu">quantile</span>(lesividad))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  `quantile(lesividad)`
                  &lt;dbl&gt;
1                     1
2                     7
3                    14
4                    14
5                    77</code></pre>
</div>
</div>
</div>
</section>
<section id="tip-percent_rank" class="slide level2">
<h2>Tip: percent_rank()</h2>
<p>La función <code>percent_rank()</code> es bastante útil para, dada una variable, calcular en qué <span class="hl-yellow"><strong>percentil se sitúa cada observación</strong></span> (de 0 a 1: si 0.468, ese registro para dicha variable ocupa el percentil 46.8%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a>accidentes_tb <span class="sc">|&gt;</span> </span>
<span id="cb247-2"><a href="#cb247-2"></a>  <span class="fu">mutate</span>(<span class="st">"lesividad"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(lesividad)) <span class="sc">|&gt;</span> </span>
<span id="cb247-3"><a href="#cb247-3"></a>  <span class="fu">drop_na</span>(lesividad) <span class="sc">|&gt;</span> </span>
<span id="cb247-4"><a href="#cb247-4"></a>  <span class="fu">mutate</span>(<span class="st">"lesividad_rank"</span> <span class="ot">=</span> <span class="fu">percent_rank</span>(lesividad)) <span class="sc">|&gt;</span> </span>
<span id="cb247-5"><a href="#cb247-5"></a>  <span class="fu">select</span>(num_expediente, lesividad, lesividad_rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17,631 × 3
   num_expediente lesividad lesividad_rank
   &lt;chr&gt;              &lt;dbl&gt;          &lt;dbl&gt;
 1 2020S000006           14          0.468
 2 2020S000007            3          0.126
 3 2020S000007           14          0.468
 4 2020S000007           14          0.468
 5 2020S000015           14          0.468
 6 2020S000015           14          0.468
 7 2020S000015           14          0.468
 8 2020S000015           14          0.468
 9 2020S000017           14          0.468
10 2020S000020           14          0.468
# ℹ 17,621 more rows</code></pre>
</div>
</div>
</section>
<section id="relacionando-datos" class="slide level2">
<h2>Relacionando datos</h2>
<p>Al trabajar con datos <span class="hl-yellow"><strong>no siempre tendremos la información en una sola tabla</strong></span> y a veces nos interesará cruzar la información de distintas fuentes.</p>
<div class="fragment">
<p>Para ello usaremos un clásico de todo lenguaje que maneja datos: los famosos <span class="hl-yellow"><strong>join</strong></span>, que nos permitirán <span class="hl-yellow"><strong>cruzar una o varias tablas</strong></span>, haciendo uso de una <span class="hl-yellow"><strong>columna identificadora</strong></span> de cada una de ellas (por ejemplo, imagina que cruzamos datos de hacienda y de antecedentes penales, haciendo <code>join</code> por la columna <code>DNI</code>).</p>
</div>
</section>
<section id="relacionando-datos-1" class="slide level2">
<h2>Relacionando datos</h2>
<p>La estructura básica es la siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a>tabla_1 <span class="sc">|&gt;</span></span>
<span id="cb249-2"><a href="#cb249-2"></a>  <span class="fu">xxx_join</span>(tabla_2, <span class="at">by =</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="img/sql-joins.jpg" class="r-stretch"><div class="fragment">
<p>Vamos a probar los distintos joins con un ejemplo sencillo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb250-2"><a href="#cb250-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1"></a>tb_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_x
  &lt;int&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   
3     3 x3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1"></a>tb_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_y
  &lt;dbl&gt; &lt;chr&gt;
1     1 y1   
2     2 y2   
3     4 y3   </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="left-join" class="slide level2">
<h2>Left join</h2>
<ul>
<li><code>left_join()</code>: mantiene <span class="hl-yellow"><strong>todos los registros de la primera tabla</strong></span>, y busca cuales tienen id también en la segunda (en caso de <span class="hl-yellow"><strong>no tenerlo se rellena con NA</strong></span> los campos de la 2ª tabla).</li>
</ul>
<p>En nuestra caso queremos incorporar a <code>tb_1</code> la información de <code>tb_2</code>, identificando los registros por la columna key (<code>by = "key"</code>, la columna por la que tiene que cruzar)</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1"></a>tb_1  <span class="sc">|&gt;</span> </span>
<span id="cb255-2"><a href="#cb255-2"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/left_join.jpg"></p>
</div>
</div>
</section>
<section id="left-join-1" class="slide level2">
<h2>Left join</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb257-2"><a href="#cb257-2"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
<p>Fíjate que los <span class="hl-yellow"><strong>registros de la primera cuya key no ha encontrado en la segunda</strong></span> les ha dado el valor de <span class="hl-yellow"><strong>ausente</strong></span>.</p>
</section>
<section id="right-join" class="slide level2">
<h2>Right join</h2>
<ul>
<li><code>right_join()</code>: mantiene <span class="hl-yellow"><strong>todos los registros de la segunda tabla</strong></span>, y busca cuales tienen id también en la primera.</li>
</ul>
<p>Vamos ahora a incorporar a <code>tb_2</code> la información de <code>tb_1</code>, identificando los registros por la columna key (<code>by = "key"</code>)</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb259-2"><a href="#cb259-2"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/right_join.jpg"></p>
</div>
</div>
</section>
<section id="right-join-1" class="slide level2">
<h2>Right join</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb261-2"><a href="#cb261-2"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
<p>Fíjate que ahora los <span class="hl-yellow"><strong>registros de la segunda cuya key no ha encontrado en la primera</strong></span> son los que les ha dado el valor de <span class="hl-yellow"><strong>ausente</strong></span>.</p>
</section>
<section id="claves-y-sufijos" class="slide level2">
<h2>Claves y sufijos</h2>
<p>Las columnas clave que usaremos para el cruce <span class="hl-yellow"><strong>no siempre se llamarán igual</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb263-2"><a href="#cb263-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<ul>
<li><code>by = c("key_2" = "key_2")</code>: le indicaremos en qué columna de cada tabla están las claves por las que vamos a cruzar.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1"></a><span class="co"># Left</span></span>
<span id="cb264-2"><a href="#cb264-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb264-3"><a href="#cb264-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1"></a><span class="co"># Right</span></span>
<span id="cb266-2"><a href="#cb266-2"></a>tb_1  <span class="sc">|&gt;</span> </span>
<span id="cb266-3"><a href="#cb266-3"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="claves-y-sufijos-1" class="slide level2">
<h2>Claves y sufijos</h2>
<p>Además podemos <span class="hl-yellow"><strong>cruzar por varias columnas a la vez</strong></span> (interpretará como igual registro aquel que tenga el conjunto de claves igual), con <code>by = c("var1_t1" = "var1_t2", "var2_t1" = "var2_t2", ...)</code>. Modifiquemos el ejemplo anterior</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),  <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb268-2"><a href="#cb268-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"k_21"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"k_22"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"e"</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1"></a><span class="co"># Left</span></span>
<span id="cb269-2"><a href="#cb269-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb269-3"><a href="#cb269-3"></a>  <span class="fu">left_join</span>(tb_2,</span>
<span id="cb269-4"><a href="#cb269-4"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="st">"k_21"</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="st">"k_22"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
   k_11 k_12  val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1     1 a     x1    y1   
2     2 b     x2    y2   
3     3 c     x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div>
</section>
<section id="claves-y-sufijos-2" class="slide level2">
<h2>Claves y sufijos</h2>
<p>También podría suceder que al cruzar dos tablas, haya <span class="hl-yellow"><strong>columnas de valores que se llamen igual</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb271-2"><a href="#cb271-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1"></a><span class="co"># Left</span></span>
<span id="cb272-2"><a href="#cb272-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb272-3"><a href="#cb272-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
<p>Fíjate que <span class="hl-yellow"><strong>por defecto nos añade los sufijos</strong></span> <code>.x</code> y <code>.y</code> para indicarnos de que tabla vienen.</p>
</div>
</section>
<section id="claves-y-sufijos-3" class="slide level2">
<h2>Claves y sufijos</h2>
<p>Dicho <span class="hl-yellow"><strong>sufijo podemos especificárselo</strong></span> en el argumento opcional <code>suffix = ...</code>, que nos permita <span class="hl-yellow"><strong>distinguir las variables</strong></span> de una tabla y de otra.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1"></a><span class="co"># Left</span></span>
<span id="cb274-2"><a href="#cb274-2"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb274-3"><a href="#cb274-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_tabla1"</span>, <span class="st">"_tabla2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_tabla1 val_tabla2
  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
1     1 x1         y1        
2     2 x2         y2        
3     3 x3         &lt;NA&gt;      </code></pre>
</div>
</div>
</section>
<section id="full-join" class="slide level2">
<h2>Full join</h2>
<ul>
<li><code>full_join()</code>: mantiene <span class="hl-yellow"><strong>todos los registros de ambas</strong></span> tablas.</li>
</ul>
<p>Los dos anteriores casos forman lo que se conoce como <span class="hl-yellow"><strong>outer joins</strong></span>: cruces donde se mantienen observaciones que salgan en al menos una tabla. El tercer outer join es el conocido como <code>full_join()</code> que nos <span class="hl-yellow"><strong>mantendrá las observaciones de ambas</strong></span> tablas, <span class="hl-yellow"><strong>añadiendo las filas</strong></span> que no casen con la otra tabla.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb276-2"><a href="#cb276-2"></a>  <span class="fu">full_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; 
4     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/full_join.jpg"></p>
</div>
</div>
</section>
<section id="inner-join" class="slide level2">
<h2>Inner join</h2>
<ul>
<li><code>inner_join()</code>: solo sobreviven los <span class="hl-yellow"><strong>registros cuyo id esté en ambas</strong></span> tablas.</li>
</ul>
<p>Frente a los outer join está lo que se conoce como <span class="hl-yellow"><strong>inner join</strong></span>, con <code>inner_join()</code>: un cruce en el que solo se mantienen las <span class="hl-yellow"><strong>observaciones que salgan en ambas tablas</strong></span>, solo mantiene aquellos registros matcheados.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb278-2"><a href="#cb278-2"></a>  <span class="fu">inner_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/inner_join.png"></p>
</div>
</div>
</section>
<section id="inner-join-1" class="slide level2">
<h2>Inner join</h2>
<p>Fíjate que en términos de registros, <code>inner_join</code> si es conmutativa, <strong>nos da igual el orden de las tablas</strong>: lo único que cambia es el orden de las columnas que añade.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb280-2"><a href="#cb280-2"></a>  <span class="fu">inner_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1"></a>tb_2 <span class="sc">|&gt;</span> </span>
<span id="cb282-2"><a href="#cb282-2"></a>  <span class="fu">inner_join</span>(tb_1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="st">"key_1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_2 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 y1    x1   
2     2 y2    x2   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="antisemi-join" class="slide level2">
<h2>Anti/semi join</h2>
<p>Por último tenemos dos herramientas interesantes para <span class="hl-yellow"><strong>filtrar (no cruzar) registros</strong></span>: <code>semi_join()</code> y <code>anti_join()</code>. El <span class="hl-yellow"><strong>semi join</strong></span> nos deja en la <span class="hl-yellow"><strong>primera tabla los registros que cuya clave está también en la segunda</strong></span> (como un inner join pero sin añadir la info de la segunda tabla). Y el segundo, los anti join, hace justo lo contrario (aquellos que no están).</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1"></a><span class="co"># semijoin</span></span>
<span id="cb284-2"><a href="#cb284-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb284-3"><a href="#cb284-3"></a>  <span class="fu">semi_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  key_1 val  
  &lt;int&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1"></a><span class="co"># antijoin</span></span>
<span id="cb286-2"><a href="#cb286-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb286-3"><a href="#cb286-3"></a>  <span class="fu">anti_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  key_1 val  
  &lt;int&gt; &lt;chr&gt;
1     3 x3   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-1-3" class="slide level2">
<h2>💻 Tu turno</h2>
<p><span style="color:#444442;"><strong>Intenta realizar los siguientes ejercicios sin mirar las soluciones</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1"><span class="hl-yellow"><strong>Ejercicio 1</strong></span></a></li><li><a href="#tabset-3-2"><span class="hl-yellow"><strong>Ejercicio 2</strong></span></a></li><li><a href="#tabset-3-3"><span class="hl-yellow"><strong>Ejercicio 3</strong></span></a></li><li><a href="#tabset-3-4"><span class="hl-yellow"><strong>Ejercicio 4</strong></span></a></li><li><a href="#tabset-3-5"><span class="hl-yellow"><strong>Ejercicio 5</strong></span></a></li><li><a href="#tabset-3-6"><span class="hl-yellow"><strong>Ejercicio 6</strong></span></a></li><li><a href="#tabset-3-7"><span class="hl-yellow"><strong>Ejercicio 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<p>📝 Vamos a realizar un <span class="hl-yellow"><strong>análisis de las canciones Taylor Swift</strong></span> haciendo uso del paquete <code>{taylor}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1"></a><span class="fu">library</span>(taylor)</span>
<span id="cb288-2"><a href="#cb288-2"></a>taylor_album_songs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 240 × 29
   album_name   ep    album_release track_number track_name     artist featuring
   &lt;chr&gt;        &lt;lgl&gt; &lt;date&gt;               &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;    
 1 Taylor Swift FALSE 2006-10-24               1 Tim McGraw     Taylo… &lt;NA&gt;     
 2 Taylor Swift FALSE 2006-10-24               2 Picture To Bu… Taylo… &lt;NA&gt;     
 3 Taylor Swift FALSE 2006-10-24               3 Teardrops On … Taylo… &lt;NA&gt;     
 4 Taylor Swift FALSE 2006-10-24               4 A Place In Th… Taylo… &lt;NA&gt;     
 5 Taylor Swift FALSE 2006-10-24               5 Cold As You    Taylo… &lt;NA&gt;     
 6 Taylor Swift FALSE 2006-10-24               6 The Outside    Taylo… &lt;NA&gt;     
 7 Taylor Swift FALSE 2006-10-24               7 Tied Together… Taylo… &lt;NA&gt;     
 8 Taylor Swift FALSE 2006-10-24               8 Stay Beautiful Taylo… &lt;NA&gt;     
 9 Taylor Swift FALSE 2006-10-24               9 Should've Sai… Taylo… &lt;NA&gt;     
10 Taylor Swift FALSE 2006-10-24              10 Mary's Song (… Taylo… &lt;NA&gt;     
# ℹ 230 more rows
# ℹ 22 more variables: bonus_track &lt;lgl&gt;, promotional_release &lt;date&gt;,
#   single_release &lt;date&gt;, track_release &lt;date&gt;, danceability &lt;dbl&gt;,
#   energy &lt;dbl&gt;, key &lt;int&gt;, loudness &lt;dbl&gt;, mode &lt;int&gt;, speechiness &lt;dbl&gt;,
#   acousticness &lt;dbl&gt;, instrumentalness &lt;dbl&gt;, liveness &lt;dbl&gt;, valence &lt;dbl&gt;,
#   tempo &lt;dbl&gt;, time_signature &lt;int&gt;, duration_ms &lt;int&gt;, explicit &lt;lgl&gt;,
#   key_name &lt;chr&gt;, mode_name &lt;chr&gt;, key_mode &lt;chr&gt;, lyrics &lt;list&gt;</code></pre>
</div>
</div>
<p>¿Cuántas canciones hay guardadas? ¿Cuántas características de cada una?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1"></a>taylor_album_songs <span class="sc">|&gt;</span> <span class="fu">nrow</span>()</span>
<span id="cb290-2"><a href="#cb290-2"></a>taylor_album_songs <span class="sc">|&gt;</span> <span class="fu">ncol</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2">
<p>📝 Obtén los álbumes únicos del dataset. ¿Cuántos hay?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1"></a>taylor_album_songs <span class="sc">|&gt;</span> <span class="fu">distinct</span>(album_name)</span>
<span id="cb291-2"><a href="#cb291-2"></a>taylor_album_songs <span class="sc">|&gt;</span></span>
<span id="cb291-3"><a href="#cb291-3"></a>  <span class="fu">distinct</span>(album_name) <span class="sc">|&gt;</span></span>
<span id="cb291-4"><a href="#cb291-4"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-3">
<p>📝 ¿En cuántas canciones tuvo colaboración con otro artista?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1"></a><span class="co"># nº canciones con colaboración</span></span>
<span id="cb292-2"><a href="#cb292-2"></a>taylor_album_songs <span class="sc">|&gt;</span></span>
<span id="cb292-3"><a href="#cb292-3"></a>  <span class="fu">drop_na</span>(featuring) <span class="sc">|&gt;</span></span>
<span id="cb292-4"><a href="#cb292-4"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-4">
<p>📝 ¿Cuántos artistas (únicos) han colaborado con ella?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1"></a><span class="co"># nº de colaboradores únicos</span></span>
<span id="cb293-2"><a href="#cb293-2"></a>taylor_album_songs <span class="sc">|&gt;</span></span>
<span id="cb293-3"><a href="#cb293-3"></a>  <span class="fu">drop_na</span>(featuring) <span class="sc">|&gt;</span> </span>
<span id="cb293-4"><a href="#cb293-4"></a>  <span class="fu">summarise</span>(<span class="at">n_collabs =</span> <span class="fu">n_distinct</span>(featuring))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-5">
<p>📝 Crea un nuevo <code>tibble</code> solo con las variables <code>album_name</code>, <code>album_release</code>, <code>track_name</code>, <code>featuring</code> y <code>duration_ms</code>. Después ordena dicho tibble de más reciente a más antiguo</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1"></a>nuevo_tb <span class="ot">&lt;-</span></span>
<span id="cb294-2"><a href="#cb294-2"></a>  taylor_album_songs <span class="sc">|&gt;</span></span>
<span id="cb294-3"><a href="#cb294-3"></a>  <span class="fu">select</span>(album_name, album_release, track_name, featuring, duration_ms)</span>
<span id="cb294-4"><a href="#cb294-4"></a>nuevo_tb <span class="sc">|&gt;</span> </span>
<span id="cb294-5"><a href="#cb294-5"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(album_release))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-6">
<p>📝 Añade al dataset anterior 2 variables con el mes y año de la variable de fecha <code>album_release</code>. Piensa cómo determinar el mes con más canciones</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb295-2"><a href="#cb295-2"></a>nuevo_tb <span class="ot">&lt;-</span></span>
<span id="cb295-3"><a href="#cb295-3"></a>  nuevo_tb <span class="sc">|&gt;</span> </span>
<span id="cb295-4"><a href="#cb295-4"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(album_release), <span class="at">year =</span> <span class="fu">year</span>(album_release)) </span>
<span id="cb295-5"><a href="#cb295-5"></a>nuevo_tb <span class="sc">|&gt;</span> </span>
<span id="cb295-6"><a href="#cb295-6"></a>  <span class="fu">count</span>(month, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-7">
<p>📝 Obtén la duración media de las canciones en minutos (variable <code>duration_ms</code> en milisegundos). Extrae la info de la canción que más dura</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1"></a>nuevo_tb <span class="sc">|&gt;</span></span>
<span id="cb296-2"><a href="#cb296-2"></a>  <span class="fu">drop_na</span>(duration_ms) <span class="sc">|&gt;</span> </span>
<span id="cb296-3"><a href="#cb296-3"></a>  <span class="fu">summarise</span>(<span class="at">avg_dur =</span> <span class="fu">mean</span>(duration_ms<span class="sc">/</span><span class="dv">60000</span>))</span>
<span id="cb296-4"><a href="#cb296-4"></a></span>
<span id="cb296-5"><a href="#cb296-5"></a>nuevo_tb <span class="sc">|&gt;</span> </span>
<span id="cb296-6"><a href="#cb296-6"></a>  <span class="fu">slice_max</span>(duration_ms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-1-3" class="slide level2">
<h2>🐣 Caso práctico III: starwars</h2>
<p>Vamos a usar al dataset <code>starwars</code> del paquete <code>{dplyr}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb297-2"><a href="#cb297-2"></a>starwars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<p>Intenta responder a las preguntas planteadas en el <a href="https://javieralvarezliebana.quarto.pub/workbook-rtve/#caso-pr%C3%A1ctico-iii-starwars-dplyr"><strong>workbook</strong></a></p>
</section>
<section id="caso-practico-1-4" class="slide level2">
<h2>🐣 Caso práctico IV: aviones</h2>
<p>Para los ejercicios usaremos las tablas disponibles en el paquete <code>{nycflights13}</code> (echa un vistazo antes)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1"></a><span class="fu">library</span>(nycflights13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><span class="hl-yellow"><strong>airlines</strong></span>: nombre de aerolíneas (con su abreviatura).</li>
<li><span class="hl-yellow"><strong>airports</strong></span>: datos de aeropuertos (nombres, longitud, latitud, altitud, etc).</li>
<li><span class="hl-yellow"><strong>flights</strong></span>: datos de vuelos.</li>
<li><span class="hl-yellow"><strong>planes</strong></span>: datos de los aviones.</li>
<li><span class="hl-yellow"><strong>weather</strong></span>: datos meteorológicos horarios de las estaciones LGA, JFK y EWR.</li>
</ul>
<p>Intenta responder a las preguntas planteadas en el <a href="https://javieralvarezliebana.quarto.pub/workbook-rtve/#caso-pr%C3%A1ctico-iv-aviones-de-nyc-join"><strong>workbook</strong></a></p>
</section></section>
<section>
<section id="clase-2" class="title-slide slide level1 center">
<h1>Clase 2: <span class="flow">welcome to R again</span></h1>
<p><span style="color:#444442;"><strong>…</strong></span></p>
<ul>
<li><a href="#/import-export">Importar y exportar</a></li>
</ul>
</section>
<section id="import-export" class="slide level2">
<h2>Importar/exportar</h2>
<p>Hasta ahora sólo hemos utilizado datos ya cargados en paquetes, pero muchas veces <span class="hl-yellow"><strong>necesitaremos importar datos externamente</strong></span>. Una de las principales <span class="hl-yellow"><strong>fortalezas</strong></span> de <code>R</code> es que podemos importar datos muy fácilmente en diferentes formatos:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Formatos nativos de R</strong></span>: archivos <code>.rda</code>, <code>.RData</code> y <code>.rds</code></p></li>
<li><p><span class="hl-yellow"><strong>Rectangular data (datos tabulados)</strong></span>: archivos <code>.csv</code> y <code>.tsv</code></p></li>
<li><p><span class="hl-yellow"><strong>Datos sin tabular</strong></span>: archivos <code>.txt</code>.</p></li>
<li><p><span class="hl-yellow"><strong>Datos en excel</strong></span>: archivos <code>.xls</code> y<code>.xlsx</code>.</p></li>
<li><p><span class="hl-yellow"><strong>Datos desde SAS/Stata/SPSS</strong></span>: archivos <code>.sas7bdat</code>, <code>.sav</code> y <code>.dat</code>.</p></li>
<li><p><span class="hl-yellow"><strong>Datos desde Google Drive</strong></span></p></li>
<li><p><span class="hl-yellow"><strong>Datos desde API’s</strong></span>: aemet, catastro, censo, spotify, etc.</p></li>
</ul>
</section>
<section id="formatos-nativos" class="slide level2">
<h2>Formatos nativos</h2>
<p>Los ficheros <span class="hl-yellow"><strong>más sencillos</strong></span> para importar a <code>R</code> (y que suelen ocupar menos espacio en disco) son sus propias <span class="hl-yellow"><strong>extensiones nativas</strong></span>: ficheros en formatos <code>.RData</code>, <code>.rda</code> y <code>.rds</code>. Para cargar los primeros basta con <span class="hl-yellow"><strong>utilizar la función</strong></span> <code>load()</code> proporcionándole la ruta del fichero.</p>
<ul>
<li>Archivos <code>RData</code>: vamos a importar el archivo <code>world_bank_pop.RData</code> que incluye la tabla <code>world_bank_pop</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1"></a><span class="fu">load</span>(<span class="st">"./datos/world_bank_pop.RData"</span>)</span>
<span id="cb300-2"><a href="#cb300-2"></a>world_bank_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,064 × 20
   country indicator      `2000`  `2001`  `2002`  `2003`  `2004`  `2005`  `2006`
   &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 ABW     SP.URB.TOTL    4.16e4 4.20e+4 4.22e+4 4.23e+4 4.23e+4 4.24e+4 4.26e+4
 2 ABW     SP.URB.GROW    1.66e0 9.56e-1 4.01e-1 1.97e-1 9.46e-2 1.94e-1 3.67e-1
 3 ABW     SP.POP.TOTL    8.91e4 9.07e+4 9.18e+4 9.27e+4 9.35e+4 9.45e+4 9.56e+4
 4 ABW     SP.POP.GROW    2.54e0 1.77e+0 1.19e+0 9.97e-1 9.01e-1 1.00e+0 1.18e+0
 5 AFE     SP.URB.TOTL    1.16e8 1.20e+8 1.24e+8 1.29e+8 1.34e+8 1.39e+8 1.44e+8
 6 AFE     SP.URB.GROW    3.60e0 3.66e+0 3.72e+0 3.71e+0 3.74e+0 3.81e+0 3.81e+0
 7 AFE     SP.POP.TOTL    4.02e8 4.12e+8 4.23e+8 4.34e+8 4.45e+8 4.57e+8 4.70e+8
 8 AFE     SP.POP.GROW    2.58e0 2.59e+0 2.61e+0 2.62e+0 2.64e+0 2.67e+0 2.70e+0
 9 AFG     SP.URB.TOTL    4.31e6 4.36e+6 4.67e+6 5.06e+6 5.30e+6 5.54e+6 5.83e+6
10 AFG     SP.URB.GROW    1.86e0 1.15e+0 6.86e+0 7.95e+0 4.59e+0 4.47e+0 5.03e+0
# ℹ 1,054 more rows
# ℹ 11 more variables: `2007` &lt;dbl&gt;, `2008` &lt;dbl&gt;, `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;,
#   `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;,
#   `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="formatos-nativos-1" class="slide level2">
<h2>Formatos nativos</h2>
<ul>
<li>Archivos <code>.rda</code>: vamos a importar el dataset airquality desde <code>airquality.rda</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1"></a><span class="fu">load</span>(<span class="st">"./datos/airquality.rda"</span>)</span>
<span id="cb302-2"><a href="#cb302-2"></a>airquality <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 153 × 6
   Ozone Solar.R  Wind  Temp Month   Day
   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1    41     190   7.4    67     5     1
 2    36     118   8      72     5     2
 3    12     149  12.6    74     5     3
 4    18     313  11.5    62     5     4
 5    NA      NA  14.3    56     5     5
 6    28      NA  14.9    66     5     6
 7    23     299   8.6    65     5     7
 8    19      99  13.8    59     5     8
 9     8      19  20.1    61     5     9
10    NA     194   8.6    69     5    10
# ℹ 143 more rows</code></pre>
</div>
</div>
</section>
<section id="formatos-nativos-2" class="slide level2">
<h2>Formatos nativos</h2>
<p>Tenga en cuenta que los archivos cargados con <code>load()</code> se cargan <span class="hl-yellow"><strong>automáticamente en el entorno</strong></span> (con el nombre guardado originalmente), y no sólo se pueden cargar conjuntos de datos: <code>load()</code> nos permite cargar múltiples objetos (no sólo datos tabulares).</p>
<p>Los archivos nativos <code>.rda</code> y <code>.RData</code> son una forma adecuada de guardar el entorno.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"./datos/multiple_objects.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="formatos-nativos-3" class="slide level2">
<h2>Formatos nativos</h2>
<ul>
<li>Archivos <code>.rds</code>: para este tipo debemos utilizar <code>readRDS()</code>, y necesitamos incorporar un <span class="hl-yellow"><strong>argumento <code>file</code></strong></span> con la ruta. En este caso vamos a importar <span class="hl-purple"><strong>datos de cáncer de pulmón</strong></span> del North Central Cancer Treatment Group. Observe que ahora <span class="hl-red"><strong>los archivos .rds incorporar solo una tabla, no un objeto en general</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1"></a>lung_cancer <span class="ot">&lt;-</span></span>
<span id="cb305-2"><a href="#cb305-2"></a>  <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"./datos/NCCTG_lung_cancer.rds"</span>) <span class="sc">|&gt;</span></span>
<span id="cb305-3"><a href="#cb305-3"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb305-4"><a href="#cb305-4"></a>lung_cancer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 228 × 10
    inst  time status   age   sex ph.ecog ph.karno pat.karno meal.cal wt.loss
   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1     3   306      2    74     1       1       90       100     1175      NA
 2     3   455      2    68     1       0       90        90     1225      15
 3     3  1010      1    56     1       0       90        90       NA      15
 4     5   210      2    57     1       1       90        60     1150      11
 5     1   883      2    60     1       0      100        90       NA       0
 6    12  1022      1    74     1       1       50        80      513       0
 7     7   310      2    68     2       2       70        60      384      10
 8    11   361      2    71     2       2       60        80      538       1
 9     1   218      2    53     1       1       70        80      825      16
10     7   166      2    61     1       2       70        70      271      34
# ℹ 218 more rows</code></pre>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante</strong></p>
</div>
<div class="callout-content">
<p>Las [<strong>rutas</strong>]{.hl-yellow deben ser siempre <span class="hl-yellow"><strong>sin espacios, ñ, ni acentos</strong></span>.</p>
</div>
</div>
</div>
</section>
<section id="datos-tabulados-readr" class="slide level2">
<h2>Datos tabulados: readr</h2>
<p>El paquete <code>{readr}</code> dentro del entorno <code>{tidyverse}</code> contiene varias funciones útiles para <span class="hl-yellow"><strong>cargar datos rectangulares (sin formatear pero tabulados)</strong></span>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><code>read_csv()</code>: archivos <code>.csv</code> <span class="hl-purple"><strong>variables separadas por comas</strong></span></li>
<li><code>read_csv2()</code>: variables separadas por <span class="hl-purple"><strong>punto y coma</strong></span></li>
<li><code>read_tsv()</code>: variables separadas por <span class="hl-purple"><strong>tabuladores</strong></span>.</li>
<li><code>read_table()</code>: variables separadas por <span class="hl-purple"><strong>espacios</strong></span>.</li>
<li><code>read_delim()</code>: función generar con opción de <span class="hl-purple"><strong>especificar el delimitador</strong></span>.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/data-import-readr.png"></p>
</div>
</div>
<p>Todos ellos necesitan como <strong>argumento la ruta del fichero</strong> más <strong>otros opcionales</strong> (saltar cabecera o no, decimales, etc). Ver más en <a href="https://readr.tidyverse.org/" class="uri">https://readr.tidyverse.org/</a></p>
</section>
<section id="datos-tabulados-.csv-.tsv" class="slide level2">
<h2>Datos tabulados (.csv, .tsv)</h2>
<p>La principal ventaja de <code>{readr}</code> es que <span class="hl-yellow"><strong>automatiza el formato</strong></span> para pasar de un fichero plano (sin formato) a un tibble (en filas y columnas, con formato).</p>
<div class="fragment">
<ul>
<li>Archivo <code>.csv</code>: con <code>read_csv()</code> cargaremos archivos <span class="hl-purple"><strong>separados por comas</strong></span>, pasando como <span class="hl-yellow"><strong>argumento la ruta</strong></span> en <code>file = ...</code>. Vamos a importar el conjunto de datos <code>chickens.csv</code> (sobre pollos de dibujos animados, por qué no). Si nos fijamos en la salida nos da el tipo de variables.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb307-2"><a href="#cb307-2"></a>chickens <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/chickens.csv"</span>)</span>
<span id="cb307-3"><a href="#cb307-3"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  chicken                 sex     eggs_laid motto                               
  &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                               
1 Foghorn Leghorn         rooster         0 That's a joke, ah say, that's a jok…
2 Chicken Little          hen             3 The sky is falling!                 
3 Ginger                  hen            12 Listen. We'll either die free chick…
4 Camilla the Chicken     hen             7 Bawk, buck, ba-gawk.                
5 Ernie The Giant Chicken rooster         0 Put Captain Solo in the cargo hold. </code></pre>
</div>
</div>
</div>
</section>
<section id="datos-tabulados-.csv-.tsv-1" class="slide level2">
<h2>Datos tabulados (.csv, .tsv)</h2>
<p>El <span class="hl-yellow"><strong>formato de la variable</strong></span> se hará normalmente <span class="hl-yellow"><strong>automáticamente</strong></span> por <code>read_csv()</code>, y podemos consultarlo con <code>spec()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1"></a><span class="fu">spec</span>(chickens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  chicken = col_character(),
  sex = col_character(),
  eggs_laid = col_double(),
  motto = col_character()
)</code></pre>
</div>
</div>
</section>
<section id="datos-tabulados-.csv-.tsv-2" class="slide level2">
<h2>Datos tabulados (.csv, .tsv)</h2>
<p>Aunque normalmente lo hace bien automáticamente podemos <span class="hl-yellow"><strong>especificar el formato explícitamente</strong></span> en <code>col_types = lista()</code> (en formato lista, con <code>col_xxx()</code> para cada tipo de variable, por ejemplo <code>eggs_laid</code> se importará como carácter).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1"></a>chickens <span class="ot">&lt;-</span></span>
<span id="cb311-2"><a href="#cb311-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/chickens.csv"</span>,</span>
<span id="cb311-3"><a href="#cb311-3"></a>           <span class="at">col_types =</span> <span class="fu">list</span>(<span class="fu">col_character</span>(), <span class="fu">col_character</span>(),</span>
<span id="cb311-4"><a href="#cb311-4"></a>                            <span class="fu">col_character</span>(), <span class="fu">col_character</span>()))</span>
<span id="cb311-5"><a href="#cb311-5"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  chicken                 sex     eggs_laid motto                               
  &lt;chr&gt;                   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;                               
1 Foghorn Leghorn         rooster 0         That's a joke, ah say, that's a jok…
2 Chicken Little          hen     3         The sky is falling!                 
3 Ginger                  hen     12        Listen. We'll either die free chick…
4 Camilla the Chicken     hen     7         Bawk, buck, ba-gawk.                
5 Ernie The Giant Chicken rooster 0         Put Captain Solo in the cargo hold. </code></pre>
</div>
</div>
</section>
<section id="datos-tabulados-.csv-.tsv-3" class="slide level2">
<h2>Datos tabulados (.csv, .tsv)</h2>
<p>Incluso podemos indicar que <span class="hl-yellow"><strong>variables queremos seleccionar</strong></span> (sin ocupar memoria), indicándolo en <code>col_select = ...</code> (en formato lista, con <code>col_select = ...</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1"></a>chickens <span class="ot">&lt;-</span></span>
<span id="cb313-2"><a href="#cb313-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/chickens.csv"</span>,</span>
<span id="cb313-3"><a href="#cb313-3"></a>           <span class="at">col_select =</span> <span class="fu">c</span>(chicken, sex, eggs_laid))</span>
<span id="cb313-4"><a href="#cb313-4"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  chicken                 sex     eggs_laid
  &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt;
1 Foghorn Leghorn         rooster         0
2 Chicken Little          hen             3
3 Ginger                  hen            12
4 Camilla the Chicken     hen             7
5 Ernie The Giant Chicken rooster         0</code></pre>
</div>
</div>
</section>
<section id="datos-tabulados-.txt" class="slide level2">
<h2>Datos tabulados (.txt)</h2>
<p>¿Qué ocurre cuando el <span class="hl-red"><strong>separador no es correcto</strong></span>?</p>
<div class="fragment">
<p>Si usamos <code>read_csv()</code> espera que el separador entre columnas sea una coma pero, como puedes ver con el siguiente <code>.txt</code>, lo interpreta todo como una sola columna: <span class="hl-yellow"><strong>no tiene coma y no sabe dónde separar</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1"></a>datos_txt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/massey-rating.txt"</span>)</span>
<span id="cb315-2"><a href="#cb315-2"></a><span class="fu">dim</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1"></a><span class="fu">as_tibble</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
   `UCC PAY LAZ KPK  RT   COF BIH DII ENG ACU Rank Team            Conf`
   &lt;chr&gt;                                                                
 1 1   1   1   1   1     1   1   1   1   1    1 Ohio St          B10    
 2 2   2   2   2   2     2   2   2   4   2    2 Oregon           P12    
 3 3   4   3   4   3     4   3   4   2   3    3 Alabama          SEC    
 4 4   3   4   3   4     3   5   3   3   4    4 TCU              B12    
 5 6   6   6   5   5     7   6   5   6  11    5 Michigan St      B10    
 6 7   7   7   6   7     6  11   8   7   8    6 Georgia          SEC    
 7 5   5   5   7   6     8   4   6   5   5    7 Florida St       ACC    
 8 8   8   9   9  10     5   7   7  10   7    8 Baylor           B12    
 9 9  11   8  13  11    11  12   9  14   9    9 Georgia Tech     ACC    
10 13  10  13  11   8     9  10  11   9  10   10 Mississippi      SEC   </code></pre>
</div>
</div>
</div>
</section>
<section id="datos-tabulados-.txt-1" class="slide level2">
<h2>Datos tabulados (.txt)</h2>
<p>Para ello tenemos.</p>
<ul>
<li><p><code>read_csv2()</code> cuando el <span class="hl-yellow"><strong>separador es punto y coma</strong></span>, <code>read_tsv()</code> cuando es un <span class="hl-yellow"><strong>tabulador</strong></span> y <code>read_table()</code> cuando es un <span class="hl-yellow"><strong>espacio</strong></span>.</p></li>
<li><p><code>read_delim()</code> en general.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1"></a>datos_txt <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="at">file =</span> <span class="st">"./datos/massey-rating.txt"</span>)</span>
<span id="cb319-2"><a href="#cb319-2"></a><span class="fu">as_tibble</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 13
     UCC   PAY   LAZ   KPK    RT   COF   BIH   DII   ENG   ACU  Rank Team  Conf 
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
 1     1     1     1     1     1     1     1     1     1     1     1 Ohio  St   
 2     2     2     2     2     2     2     2     2     4     2     2 Oreg… P12  
 3     3     4     3     4     3     4     3     4     2     3     3 Alab… SEC  
 4     4     3     4     3     4     3     5     3     3     4     4 TCU   B12  
 5     6     6     6     5     5     7     6     5     6    11     5 Mich… St   
 6     7     7     7     6     7     6    11     8     7     8     6 Geor… SEC  
 7     5     5     5     7     6     8     4     6     5     5     7 Flor… St   
 8     8     8     9     9    10     5     7     7    10     7     8 Bayl… B12  
 9     9    11     8    13    11    11    12     9    14     9     9 Geor… Tech 
10    13    10    13    11     8     9    10    11     9    10    10 Miss… SEC  </code></pre>
</div>
</div>
</section>
<section id="datos-excel-.xls-.xlsx" class="slide level2">
<h2>Datos Excel (.xls, .xlsx)</h2>
<p>Otro paquete de importación clave será el paquete <code>{readxl}</code> para <span class="hl-yellow"><strong>importar datos desde Excel</strong></span>. Tres funciones serán clave:</p>
<ul>
<li><code>read_xls()</code> específica para <code>.xls</code>, <code>read_xlsx()</code> específica para <code>.xlsx</code>.</li>
<li><code>read_excel()</code>: tanto para <code>.xls</code> como para <code>.xlsx</code>.</li>
</ul>
<div class="fragment">
<p>Vamos a importar <code>deaths.xlsx</code> con los registros de defunciones de famosos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb321-2"><a href="#cb321-2"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/deaths.xlsx"</span>)</span>
<span id="cb321-3"><a href="#cb321-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 6
   `Lots of people`             ...2                     ...3  ...4  ...5  ...6 
   &lt;chr&gt;                        &lt;chr&gt;                    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 simply cannot resist writing &lt;NA&gt;                     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  some…
 2 at                           the                      top   &lt;NA&gt;  of    thei…
 3 or                           merging                  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  cells
 4 Name                         Profession               Age   Has … Date… Date…
 5 David Bowie                  musician                 69    TRUE  17175 42379
 6 Carrie Fisher                actor                    60    TRUE  20749 42731
 7 Chuck Berry                  musician                 90    TRUE  9788  42812
 8 Bill Paxton                  actor                    61    TRUE  20226 42791
 9 Prince                       musician                 57    TRUE  21343 42481
10 Alan Rickman                 actor                    69    FALSE 16854 42383
11 Florence Henderson           actor                    82    TRUE  12464 42698
12 Harper Lee                   author                   89    FALSE 9615  42419
13 Zsa Zsa Gábor                actor                    99    TRUE  6247  42722
14 George Michael               musician                 53    FALSE 23187 42729
15 Some                         &lt;NA&gt;                     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
16 &lt;NA&gt;                         also like to write stuff &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
17 &lt;NA&gt;                         &lt;NA&gt;                     at t… bott… &lt;NA&gt;  &lt;NA&gt; 
18 &lt;NA&gt;                         &lt;NA&gt;                     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  too! </code></pre>
</div>
</div>
</div>
</section>
<section id="datos-excel-.xls-.xlsx-1" class="slide level2">
<h2>Datos Excel (.xls, .xlsx)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1"></a>deaths <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  `Lots of people`             ...2       ...3  ...4     ...5          ...6     
  &lt;chr&gt;                        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;    
1 simply cannot resist writing &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          some not…
2 at                           the        top   &lt;NA&gt;     of            their sp…
3 or                           merging    &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          cells    
4 Name                         Profession Age   Has kids Date of birth Date of …
5 David Bowie                  musician   69    TRUE     17175         42379    
6 Carrie Fisher                actor      60    TRUE     20749         42731    </code></pre>
</div>
</div>
<p><span class="hl-red"><strong>Una desgracia muy común</strong></span> es que haya algún tipo de comentario o texto al principio del fichero, teniendo que <span class="hl-yellow"><strong>saltar esas filas</strong></span>.</p>
</section>
<section id="datos-excel-.xls-.xlsx-2" class="slide level2">
<h2>Datos Excel (.xls, .xlsx)</h2>
<p>Podemos <span class="hl-yellow"><strong>saltar estas filas</strong></span> directamente en la carga con <code>skip = ...</code> (indicando el número de filas a saltar).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/deaths.xlsx"</span>, <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb325-2"><a href="#cb325-2"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   Name          Profession Age   `Has kids` `Date of birth`     `Date of death`
   &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;      &lt;dttm&gt;              &lt;chr&gt;          
 1 David Bowie   musician   69    TRUE       1947-01-08 00:00:00 42379          
 2 Carrie Fisher actor      60    TRUE       1956-10-21 00:00:00 42731          
 3 Chuck Berry   musician   90    TRUE       1926-10-18 00:00:00 42812          
 4 Bill Paxton   actor      61    TRUE       1955-05-17 00:00:00 42791          
 5 Prince        musician   57    TRUE       1958-06-07 00:00:00 42481          
 6 Alan Rickman  actor      69    FALSE      1946-02-21 00:00:00 42383          
 7 Florence Hen… actor      82    TRUE       1934-02-14 00:00:00 42698          
 8 Harper Lee    author     89    FALSE      1926-04-28 00:00:00 42419          
 9 Zsa Zsa Gábor actor      99    TRUE       1917-02-06 00:00:00 42722          
10 George Micha… musician   53    FALSE      1963-06-25 00:00:00 42729          
11 Some          &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;       NA                  &lt;NA&gt;           
12 &lt;NA&gt;          also like… &lt;NA&gt;  &lt;NA&gt;       NA                  &lt;NA&gt;           
13 &lt;NA&gt;          &lt;NA&gt;       at t… bottom,    NA                  &lt;NA&gt;           
14 &lt;NA&gt;          &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;       NA                  too!           </code></pre>
</div>
</div>
</section>
<section id="datos-excel-.xls-.xlsx-3" class="slide level2">
<h2>Datos Excel (.xls, .xlsx)</h2>
<p>Además con <code>col_names = ...</code> ya podemos renombrar las columnas en la importación (<span class="hl-yellow"><strong>proporcionar nombres supone 1ª línea ya como dato</strong></span>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb327" data-code-line-numbers="2-3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1"></a>deaths <span class="ot">&lt;-</span></span>
<span id="cb327-2"><a href="#cb327-2"></a>  <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/deaths.xlsx"</span>, <span class="at">skip =</span> <span class="dv">5</span>,</span>
<span id="cb327-3"><a href="#cb327-3"></a>            <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"nombre"</span>, <span class="st">"profesion"</span>, <span class="st">"edad"</span>, <span class="st">"hijos"</span>, <span class="st">"nacimiento"</span>, <span class="st">"muerte"</span>))</span>
<span id="cb327-4"><a href="#cb327-4"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   nombre             profesion           edad  hijos nacimiento          muerte
   &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt; 
 1 David Bowie        musician            69    TRUE  1947-01-08 00:00:00 42379 
 2 Carrie Fisher      actor               60    TRUE  1956-10-21 00:00:00 42731 
 3 Chuck Berry        musician            90    TRUE  1926-10-18 00:00:00 42812 
 4 Bill Paxton        actor               61    TRUE  1955-05-17 00:00:00 42791 
 5 Prince             musician            57    TRUE  1958-06-07 00:00:00 42481 
 6 Alan Rickman       actor               69    FALSE 1946-02-21 00:00:00 42383 
 7 Florence Henderson actor               82    TRUE  1934-02-14 00:00:00 42698 
 8 Harper Lee         author              89    FALSE 1926-04-28 00:00:00 42419 
 9 Zsa Zsa Gábor      actor               99    TRUE  1917-02-06 00:00:00 42722 
10 George Michael     musician            53    FALSE 1963-06-25 00:00:00 42729 
11 Some               &lt;NA&gt;                &lt;NA&gt;  &lt;NA&gt;  NA                  &lt;NA&gt;  
12 &lt;NA&gt;               also like to write… &lt;NA&gt;  &lt;NA&gt;  NA                  &lt;NA&gt;  
13 &lt;NA&gt;               &lt;NA&gt;                at t… bott… NA                  &lt;NA&gt;  
14 &lt;NA&gt;               &lt;NA&gt;                &lt;NA&gt;  &lt;NA&gt;  NA                  too!  </code></pre>
</div>
</div>
</section>
<section id="datos-excel-.xls-.xlsx-4" class="slide level2">
<h2>Datos Excel (.xls, .xlsx)</h2>
<p>A veces las <span class="hl-red"><strong>fechas de Excel tienen un formato incorrecto</strong></span> (sorpresa): podemos utilizar <code>convertToDate()</code> del paquete <code>{openxlsx}</code> para convertirlo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb329-2"><a href="#cb329-2"></a>deaths<span class="sc">$</span>muerte <span class="ot">&lt;-</span> <span class="fu">convertToDate</span>(deaths<span class="sc">$</span>muerte)</span>
<span id="cb329-3"><a href="#cb329-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   nombre             profesion       edad  hijos nacimiento          muerte    
   &lt;chr&gt;              &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;date&gt;    
 1 David Bowie        musician        69    TRUE  1947-01-08 00:00:00 2016-01-10
 2 Carrie Fisher      actor           60    TRUE  1956-10-21 00:00:00 2016-12-27
 3 Chuck Berry        musician        90    TRUE  1926-10-18 00:00:00 2017-03-18
 4 Bill Paxton        actor           61    TRUE  1955-05-17 00:00:00 2017-02-25
 5 Prince             musician        57    TRUE  1958-06-07 00:00:00 2016-04-21
 6 Alan Rickman       actor           69    FALSE 1946-02-21 00:00:00 2016-01-14
 7 Florence Henderson actor           82    TRUE  1934-02-14 00:00:00 2016-11-24
 8 Harper Lee         author          89    FALSE 1926-04-28 00:00:00 2016-02-19
 9 Zsa Zsa Gábor      actor           99    TRUE  1917-02-06 00:00:00 2016-12-18
10 George Michael     musician        53    FALSE 1963-06-25 00:00:00 2016-12-25
11 Some               &lt;NA&gt;            &lt;NA&gt;  &lt;NA&gt;  NA                  NA        
12 &lt;NA&gt;               also like to w… &lt;NA&gt;  &lt;NA&gt;  NA                  NA        
13 &lt;NA&gt;               &lt;NA&gt;            at t… bott… NA                  NA        
14 &lt;NA&gt;               &lt;NA&gt;            &lt;NA&gt;  &lt;NA&gt;  NA                  NA        </code></pre>
</div>
</div>
</section>
<section id="datos-excel-.xls-.xlsx-5" class="slide level2">
<h2>Datos Excel (.xls, .xlsx)</h2>
<p>También podemos <span class="hl-yellow"><strong>cargar un Excel con varias hojas</strong></span>: para <span class="hl-yellow"><strong>indicar la hoja</strong></span> (ya sea por su nombre o por su número) utilizaremos el argumento <code>sheet = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1"></a>mtcars <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/datasets.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"mtcars"</span>)</span>
<span id="cb331-2"><a href="#cb331-2"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 11
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ℹ 22 more rows</code></pre>
</div>
</div>
</section>
<section id="datos-excel-.xls-.xlsx-6" class="slide level2">
<h2>Datos Excel (.xls, .xlsx)</h2>
<p>Incluso podemos indicar el <span class="hl-yellow"><strong>rango de celdas</strong></span> a cargar con <code>range = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./datos/datasets.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"iris"</span>, <span class="at">range =</span> <span class="st">"C1:E4"</span>)</span>
<span id="cb333-2"><a href="#cb333-2"></a>iris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
1          1.4         0.2 setosa 
2          1.4         0.2 setosa 
3          1.3         0.2 setosa </code></pre>
</div>
</div>
</section>
<section id="importar-desde-sasstataspss" class="slide level2">
<h2>Importar desde SAS/STATA/SPSS</h2>
<p>El paquete <code>{haven}</code> dentro del universo tidyverse nos permitirá <span class="hl-yellow"><strong>importar ficheros de los 3 software de pago más importantes</strong></span>: SAS, SPSS y Stata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb335-2"><a href="#cb335-2"></a></span>
<span id="cb335-3"><a href="#cb335-3"></a><span class="co"># SAS</span></span>
<span id="cb335-4"><a href="#cb335-4"></a>iris_sas <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="at">data_file =</span> <span class="st">"./datos/iris.sas7bdat"</span>)</span>
<span id="cb335-5"><a href="#cb335-5"></a></span>
<span id="cb335-6"><a href="#cb335-6"></a><span class="co"># SPSS</span></span>
<span id="cb335-7"><a href="#cb335-7"></a>iris_spss <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="at">file =</span> <span class="st">"./datos/iris.sav"</span>)</span>
<span id="cb335-8"><a href="#cb335-8"></a></span>
<span id="cb335-9"><a href="#cb335-9"></a><span class="co"># Stata</span></span>
<span id="cb335-10"><a href="#cb335-10"></a>iris_stata <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file =</span> <span class="st">"./datos/iris.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exportar" class="slide level2">
<h2>Exportar</h2>
<p>De la misma forma que podemos importar también podemos <span class="hl-yellow"><strong>exportar</strong></span></p>
<ul>
<li>exportar en <code>.RData</code> (opción recomendada para variables almacenadas en <code>R</code>). Recuerda que esta extensión <span class="hl-yellow"><strong>sólo se puede utilizar en <code>R</code></strong></span>. Para ello, basta con utilizar <code>save(object, file = path)</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1"></a>table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb336-2"><a href="#cb336-2"></a><span class="fu">save</span>(table, <span class="at">file =</span> <span class="st">"./datos/table.RData"</span>)</span>
<span id="cb336-3"><a href="#cb336-3"></a><span class="fu">rm</span>(table) <span class="co"># eliminar</span></span>
<span id="cb336-4"><a href="#cb336-4"></a><span class="fu">load</span>(<span class="st">"./datos/table.RData"</span>)</span>
<span id="cb336-5"><a href="#cb336-5"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;int&gt; &lt;int&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="exportar-1" class="slide level2">
<h2>Exportar</h2>
<p>La ventaja de <code>.RData</code> es que podemos <span class="hl-yellow"><strong>exportar múltiples variables de nuestro environment</strong></span>, no solo un único dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1"></a>table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb338-2"><a href="#cb338-2"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb338-3"><a href="#cb338-3"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"sandra"</span>)</span>
<span id="cb338-4"><a href="#cb338-4"></a><span class="fu">save</span>(table, a, b, <span class="at">file =</span> <span class="st">"./datos/mult_obj.RData"</span>)</span>
<span id="cb338-5"><a href="#cb338-5"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"table"</span>))</span>
<span id="cb338-6"><a href="#cb338-6"></a><span class="fu">load</span>(<span class="st">"./datos/mult_obj.RData"</span>)</span>
<span id="cb338-7"><a href="#cb338-7"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;int&gt; &lt;int&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="exportar-2" class="slide level2">
<h2>Exportar</h2>
<ul>
<li><span class="hl-yellow"><strong>exportado en <code>.csv</code></strong></span>. Para ello simplemente utilizamos <code>write_csv(object, file = path)</code>, y es el más recomendable para exportar bases de datos de tamaño pequeño o mediano. Ver <a href="https://arrow.apache.org/docs/r/" class="uri">https://arrow.apache.org/docs/r/</a> para bases de datos masivas.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1"></a><span class="fu">write_csv</span>(table, <span class="at">file =</span> <span class="st">"./datos/table.csv"</span>)</span>
<span id="cb340-2"><a href="#cb340-2"></a><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/table.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="importar-desde-web" class="slide level2">
<h2>Importar desde web</h2>
<p>Una de las principales ventajas de <code>R</code> es que podemos hacer uso de todas las funciones anteriores de <span class="hl-yellow"><strong>importar pero directamente desde una web</strong></span>, sin necesidad de realizar la descarga manual: en lugar de pasarle la ruta local le indicaremos el <span class="hl-yellow"><strong>enlace</strong></span>. Por ejemplo, vamos a descargar los datos covid del ISCIII (<a href="https://cnecovid.isciii.es/covid19/#documentaci%C3%B3n-y-datos" class="uri">https://cnecovid.isciii.es/covid19/#documentaci%C3%B3n-y-datos</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1"></a>covid_data <span class="ot">&lt;-</span></span>
<span id="cb342-2"><a href="#cb342-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://cnecovid.isciii.es/covid19/resources/casos_hosp_uci_def_sexo_edad_provres.csv"</span>)</span>
<span id="cb342-3"><a href="#cb342-3"></a>covid_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 500 × 8
   provincia_iso sexo  grupo_edad fecha      num_casos num_hosp num_uci num_def
   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;      &lt;date&gt;         &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 A             H     0-9        2020-01-01         0        0       0       0
 2 A             H     10-19      2020-01-01         0        0       0       0
 3 A             H     20-29      2020-01-01         0        0       0       0
 4 A             H     30-39      2020-01-01         0        0       0       0
 5 A             H     40-49      2020-01-01         0        0       0       0
 6 A             H     50-59      2020-01-01         0        0       0       0
 7 A             H     60-69      2020-01-01         0        0       0       0
 8 A             H     70-79      2020-01-01         0        0       0       0
 9 A             H     80+        2020-01-01         0        0       0       0
10 A             H     NC         2020-01-01         0        0       0       0
# ℹ 490 more rows</code></pre>
</div>
</div>
</section>
<section id="importar-desde-wikipedia" class="slide level2">
<h2>Importar desde wikipedia</h2>
<p>El paquete <code>{rvest}</code>, uno de los más útiles de <code>{tidyverse}</code> nos permite <span class="hl-yellow"><strong>importar (scrappear) directamente desde un <code>html</code></strong></span>. Por ejemplo, para exportar tablas de wikipedia basta con <code>read_html()</code> para importar el html, <code>html_element(«table»)</code> para extraer los objetos tabla, y <code>html_table()</code> para convertir la tabla html a <code>tibble</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb344-2"><a href="#cb344-2"></a>wiki_jump <span class="ot">&lt;-</span> <span class="st">'https://en.wikipedia.org/wiki/Men%27s_long_jump_world_record_progression'</span></span>
<span id="cb344-3"><a href="#cb344-3"></a>wiki_jump <span class="sc">|&gt;</span> <span class="fu">read_html</span>() <span class="sc">|&gt;</span> </span>
<span id="cb344-4"><a href="#cb344-4"></a>  <span class="fu">html_element</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb344-5"><a href="#cb344-5"></a>  <span class="fu">html_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 5
   Mark                       Wind   Athlete                  Place        Date 
   &lt;chr&gt;                      &lt;chr&gt;  &lt;chr&gt;                    &lt;chr&gt;        &lt;chr&gt;
 1 7.61&nbsp;m (24&nbsp;ft 11+1⁄2&nbsp;in)   ""     Peter O'Connor&nbsp;(IRE)     Dublin, Ire… 5 Au…
 2 7.69&nbsp;m (25&nbsp;ft 2+3⁄4&nbsp;in)    ""     Edward Gourdin&nbsp;(USA)     Cambridge, … 23 J…
 3 7.76&nbsp;m (25&nbsp;ft 5+1⁄2&nbsp;in)    ""     Robert LeGendre&nbsp;(USA)    Paris, Fran… 7 Ju…
 4 7.89&nbsp;m (25&nbsp;ft 10+1⁄2&nbsp;in)   ""     DeHart Hubbard&nbsp;(USA)     Chicago, Un… 13 J…
 5 7.90&nbsp;m (25&nbsp;ft 11&nbsp;in)       ""     Edward Hamm&nbsp;(USA)        Cambridge, … 7 Ju…
 6 7.93&nbsp;m (26&nbsp;ft 0&nbsp;in)        "0.0"  Sylvio Cator&nbsp;(HAI)       Paris, Fran… 9 Se…
 7 7.98&nbsp;m (26&nbsp;ft 2&nbsp;in)        "0.5"  Chuhei Nambu&nbsp;(JPN)       Tokyo, Japan 27 O…
 8 8.13&nbsp;m (26&nbsp;ft 8&nbsp;in)        "1.5"  Jesse Owens&nbsp;(USA)        Ann Arbor, … 25 M…
 9 8.21&nbsp;m (26&nbsp;ft 11&nbsp;in)       "0.0"  Ralph Boston&nbsp;(USA)       Walnut, Uni… 12 A…
10 8.24&nbsp;m (27&nbsp;ft 1⁄4&nbsp;in)      "1.8"  Ralph Boston&nbsp;(USA)       Modesto, Un… 27 M…
11 8.28&nbsp;m (27&nbsp;ft 1+3⁄4&nbsp;in)    "1.2"  Ralph Boston&nbsp;(USA)       Moscow, Sov… 16 J…
12 8.31&nbsp;m (27&nbsp;ft 3&nbsp;in)&nbsp;A      "−0.1" Igor Ter-Ovanesyan&nbsp;(URS) Yerevan, So… 10 J…
13 8.33&nbsp;m (27&nbsp;ft 3+3⁄4&nbsp;in)[2] ""     Phil Shinnick&nbsp;(USA)      Modesto, Un… 25 M…
14 8.31&nbsp;m (27&nbsp;ft 3&nbsp;in)        "0.0"  Ralph Boston&nbsp;(USA)       Kingston, J… 15 A…
15 8.34&nbsp;m (27&nbsp;ft 4+1⁄4&nbsp;in)    "1.0"  Ralph Boston&nbsp;(USA)       Los Angeles… 12 S…
16 8.35&nbsp;m (27&nbsp;ft 4+1⁄2&nbsp;in)[5] "0.0"  Ralph Boston&nbsp;(USA)       Modesto, Un… 29 M…
17 8.35&nbsp;m (27&nbsp;ft 4+1⁄2&nbsp;in)&nbsp;A  "0.0"  Igor Ter-Ovanesyan&nbsp;(URS) Mexico City… 19 O…
18 8.90&nbsp;m (29&nbsp;ft 2+1⁄4&nbsp;in)&nbsp;A  "2.0"  Bob Beamon&nbsp;(USA)         Mexico City… 18 O…
19 8.95&nbsp;m (29&nbsp;ft 4+1⁄4&nbsp;in)    "0.3"  Mike Powell&nbsp;(USA)        Tokyo, Japan 30 A…</code></pre>
</div>
</div>
</section>
<section id="caso-practico-2-1" class="slide level2">
<h2>🐣 Caso práctico I: renta municipios</h2>
<p>En el archivo <code>municipios.csv</code> tenemos guardada la información de los municipios de España a fecha de 2019. La variable <code>LAU_code</code> representa el código como unidad administrativa local según la estandarización de la UE (<a href="https://ec.europa.eu/eurostat/web/nuts/local-administrative-units">ver más</a>).La variable <code>codigo_ine</code> está construida uniendo el código de la provincia y el de la comunidad autónoma.</p>
<p>Por otro lado el archivo <code>renta_mun</code> contiene datos de la renta per capita de cada unidad administrativa (municipios, distritos, provincias, comunidades autonónomas, etc) para diferentes años.</p>
<p>&nbsp;</p>
<p>Intenta responder a las preguntas planteadas en el <a href="https://javieralvarezliebana.quarto.pub/workbook-rtve/#caso-pr%C3%A1ctico-i-renta-de-municipios"><strong>workbook</strong></a></p>
<div class="footer footer-default">
<p><a href="..."><strong>Javier Álvarez Liébana</strong></a> • Curso de R impartido en RTVE</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"normal"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>